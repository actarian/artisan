{"version":3,"sources":["ng://@artisan/core/lib/storage/storage.service.ts","ng://@artisan/core/lib/auth/auth.service.ts","ng://@artisan/core/lib/config/core.config.ts","ng://@artisan/core/lib/config/config.service.ts","ng://@artisan/core/lib/content/default-content.directive.ts","ng://@artisan/core/lib/core.component.ts","node_modules/tslib/tslib.es6.js","ng://@artisan/core/lib/disposable/disposable.component.ts","ng://@artisan/core/lib/pipes/segment.pipe.ts","ng://@artisan/core/lib/logger/logger.ts","ng://@artisan/core/lib/api/api.service.ts","ng://@artisan/core/lib/translate/translate.service.ts","ng://@artisan/core/lib/routes/route.service.ts","ng://@artisan/core/lib/pages/page.component.ts","ng://@artisan/core/lib/pages/page-not-found.component.ts","ng://@artisan/core/lib/http/http-status-code.service.ts","ng://@artisan/core/lib/models/identity.service.ts","ng://@artisan/core/lib/models/entity.service.ts","ng://@artisan/core/lib/models/image.ts","ng://@artisan/core/lib/pages/link.service.ts","ng://@artisan/core/lib/pages/page.ts","ng://@artisan/core/lib/pages/page.service.ts","ng://@artisan/core/lib/pages/page-outlet.component.ts","ng://@artisan/core/lib/pages/page-resolver.ts","ng://@artisan/core/lib/pages/page-resolver.service.ts","ng://@artisan/core/lib/pages/page.guard.ts","ng://@artisan/core/lib/pages/static.guard.ts","ng://@artisan/core/lib/core.routing.ts","ng://@artisan/core/lib/forms/controls/control-base.ts","ng://@artisan/core/lib/forms/controls/control-checkbox.ts","ng://@artisan/core/lib/forms/controls/control-email.ts","ng://@artisan/core/lib/forms/controls/control-markdown.ts","ng://@artisan/core/lib/forms/controls/control-number.ts","ng://@artisan/core/lib/forms/controls/control-password.ts","ng://@artisan/core/lib/forms/controls/control-radio.ts","ng://@artisan/core/lib/forms/controls/control-select.ts","ng://@artisan/core/lib/forms/controls/control-text.ts","ng://@artisan/core/lib/forms/controls/control.service.ts","ng://@artisan/core/lib/forms/controls/match.validator.ts","ng://@artisan/core/lib/forms/form.service.ts","ng://@artisan/core/lib/editor/editor.component.ts","ng://@artisan/core/lib/forms/controls/control.component.ts","ng://@artisan/core/lib/forms/exists.validator.ts","ng://@artisan/core/lib/forms/match.validator.ts","ng://@artisan/core/lib/forms/uppercase.directive.ts","ng://@artisan/core/lib/highlight/highlight.pipe.ts","ng://@artisan/core/lib/http/http-response.interceptor.ts","ng://@artisan/core/lib/json-formatter/json-formatter.component.ts","ng://@artisan/core/lib/pipes/custom-async.pipe.ts","ng://@artisan/core/lib/labels/label.service.ts","ng://@artisan/core/lib/labels/label-async.pipe.ts","ng://@artisan/core/lib/labels/label.directive.ts","ng://@artisan/core/lib/labels/label.pipe.ts","ng://@artisan/core/lib/logger/logger.component.ts","ng://@artisan/core/lib/models/event-dispatcher.service.ts","ng://@artisan/core/lib/models/menu.service.ts","ng://@artisan/core/lib/once/once.service.ts","ng://@artisan/core/lib/pipes/asset.pipe.ts","ng://@artisan/core/lib/pipes/image.pipe.ts","ng://@artisan/core/lib/pipes/public.pipe.ts","ng://@artisan/core/lib/plugins/facebook/facebook.service.ts","ng://@artisan/core/lib/plugins/google/google-tag-manager.service.ts","ng://@artisan/core/lib/plugins/google/google-tag-manager.component.ts","ng://@artisan/core/lib/plugins/google/google.service.ts","ng://@artisan/core/lib/plugins/mapbox/mapbox.service.ts","ng://@artisan/core/lib/plugins/paypal/paypal.service.ts","ng://@artisan/core/lib/plugins/paypal/paypal-widget.component.ts","ng://@artisan/core/lib/plugins/trustpilot/trustpilot.service.ts","ng://@artisan/core/lib/plugins/trustpilot/trustpilot-widget.component.ts","ng://@artisan/core/lib/routes/route.pipe.ts","ng://@artisan/core/lib/slugs/slug.service.ts","ng://@artisan/core/lib/slugs/slug-async.pipe.ts","ng://@artisan/core/lib/slugs/slug.pipe.ts","ng://@artisan/core/lib/translate/translate.pipe.ts","ng://@artisan/core/lib/trust/safe-style.pipe.ts","ng://@artisan/core/lib/trust/safe-url.pipe.ts","ng://@artisan/core/lib/trust/trust.pipe.ts","ng://@artisan/core/lib/ui/click-outside/click-outside.directive.ts","ng://@artisan/core/lib/ui/fancybox/fancybox.directive.ts","ng://@artisan/core/lib/ui/lazy-images/lazy-images.directive.ts","ng://@artisan/core/lib/ui/modal/modal.ts","ng://@artisan/core/lib/ui/modal/modal.service.ts","ng://@artisan/core/lib/ui/modal/modal-container.component.ts","ng://@artisan/core/lib/ui/modal/modal-view.component.ts","ng://@artisan/core/lib/core.module.ts","ng://@artisan/core/lib/core.service.ts","ng://@artisan/core/lib/labels/label.ts","ng://@artisan/core/lib/models/document.ts","ng://@artisan/core/lib/models/menu-item.ts"],"names":["StorageService","prototype","delete","name","exist","get","set","value","days","on","of","tryGet","this","Injectable","args","providedIn","CookieStorageService","platformId","storageService","isSupported","setter","document","cookie","indexOf","cookieName","ca","split","i","length","c","charAt","substring","model","JSON","parse","decodeURIComponent","atob","e","console","log","cache_1","json","stringify","key","push","btoa","encodeURIComponent","interval","timeout","elapsed","checkCookie","setTimeout","expires","date","Date","setTime","getTime","toUTCString","isPlatformBrowser","Inject","PLATFORM_ID","SessionStorageService","cookieStorageService","window","sessionStorage","removeItem","undefined","cache_2","setItem","supported","LocalStorageService","localStorage","cache_3","AuthToken","accessToken","expiresIn","AuthService","injector","localStorageService","cachedRequests","paths","setToken","authToken","retryFailedRequests","getToken","getFakeToken","isValid","now","isAuthenticated","collectFailedRequest","request","Injector","Bearer","Cookie","CoreConfigPlugins","options","Object","assign","CoreTransitionConfig","CorePrebootConfig","CoreConfig","assets","authStrategy","AuthStrategy","defaultLanguage","defaultMarket","languages","id","lang","origin","pages","production","public","urlStrategy","useHash","useLang","useMarket","plugins","preboot","transition","defaultPage","notFoundPage","CORE_CONFIG","InjectionToken","ConfigService","decorators","type","DefaultContentDirective","element","container","renderer","hasContent","nativeElement","ngAfterContentChecked","childNodes","node","nodeType","clear","createEmbeddedView","default","Directive","selector","ElementRef","ViewContainerRef","Renderer2","Input","CoreComponent","ngOnInit","Component","template","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","create","DisposableComponent","unsubscribe","Subject","ngOnDestroy","next","complete","SegmentPipe","location","transform","segments","path","isArray","join","normalize","Pipe","Location","_super","LoggerError","tslib_1.__extends","HttpErrorResponse","Logger","configService","logs","_i","arguments","s","apply","concat","warn","error","http","httpError","message","status","statusText","url","ApiRequestOptions","headers","HttpHeaders","Content-Type","params","HttpParams","ApiService","defineProperty","_logger","_http","HttpClient","_state","TransferState","_platformId","_config","_origin","config","base","collection","toLowerCase","getUrl","method","first","second","_this","pipe","tap","x","logger","post","third","put","patch","identity","toCamelCase","input","output","keyCamelCase","map","slice","toString","getStateKey","flatMap","substr","keys","k","replace","makeStateKey","stateGet","stateKey","state","hasKey","cached","remove","isPlatformServer","onSerialize","statePost","TranslateService","call","use","setDefaultLang","addLangs","getBrowserLang","RouteService","translateService","route","router","segment","componentFactoryResolver","_language","BehaviorSubject","language","asObservable","_languages","pageParams$","currentMarket","setLanguages","subscribeToRouter","_lang","getValue","find","getPageParams","queryParams","distinctUntilChanged","switchMap","parsed","parseParams","forEach","serializeParams","serialized","serialize","base64","Buffer","from","_a","object","getId","snapshot","paramMap","getSlug","toRoute","data","market","marketIndex","splice","langIndex","toSlug","filter","datas","toParams","toData","getParams","events","event","ActivationEnd","firstChild","concatMap","_unused_getPageComponentFactory","pageResolver","page","resolveComponentFactory","component","setLanguage","silent","replaceState","navigate","NavigationStart","subscribe","lang_1","detectLanguage","acceptLanguage","match","detectedLanguage","regexp","RegExp","performance","time","process","hrtime","ActivatedRoute","Router","ComponentFactoryResolver","PageComponent","scrollToTop","NavigationEnd","scrollTo","routeService","slug","PageNotFoundComponent","encapsulation","ViewEncapsulation","Emulated","HttpStatusCodeService","statusCode","redirectUrl","setStatusCode","getStatusCode","getRedirectUrl","IdentityService","getList","getDetailByIdNo404","identities","getDetailById","add","update","EntityService","getDetailByName","trim","Default","Gallery","Share","LinkService","doc","addTag","definition","createElement","updateElementDefinition","head","appendChild","getTag","querySelector","updateTag","removeTag","updateElementAttribute","href","rel","attribute","setAttribute","removeAttribute","DOCUMENT","PageMeta","PageIndex","PageRelation","Page","meta","related","item","relationType","getFeature","features","getFeatures","n","Number","sort","a","getFeaturesByTypes","getGroupedFeaturesByTypes","groups","group","PageService","titleService","metaService","linkService","statusCodeService","getStatePageBySlug","catchError","getPageById","getPageBySlug","addOrUpdateMetaData","fbAppId","facebook","appId","setTitle","title","addOrUpdateMeta","property","content","getSocialImage","description","keywords","robots","locale","author","addOrUpdateLink","canonical","images","ImageType","Title","Meta","PageOutletComponent","viewContainerRef","pageService","routeReuseStrategy","shouldReuseRoute","setSnapshot","factory","instance","createComponent","resetConfig","PageResolver","PageResolverService","events$","pageToPageResolver","resolve","PageGuard","canActivate","canDeactivate","currentRoute","currentState","nextState","StaticGuard","routes","CoreRouting","NgModule","imports","RouterModule","forChild","exports","ControlBase","_originalValue","uid","label","placeholder","order","schema","min","max","required","requiredTrue","email","minLength","maxLength","pattern","reverse","disabled","step","format","ControlCheckbox","ControlEmail","ControlMarkdown","ControlNumber","ControlPassword","ControlRadio","ControlSelect","ControlText","ControlService","getValidators","control","validators","Validators","matchValidator","otherKey","otherControl","controls","errors","setErrors","toFormGroup","formControl","FormControl","disable","FormGroup","setValidators","FormService","controlService","getControlsFromOptions","o","getGroupFromOptions","getGroupFromControls","EditorComponent","markdownService","formService","pageResolverService","editing","busy","submitted","_page","_pageCopy","getControlsByPage","valueChanges","onAssign","ngAfterViewInit","takeUntil","resolver","onKeydown","ctrlKey","onReset","setValue","onSubmit","compile","animations","trigger","style","opacity","animate","MarkdownService","HostListener","ControlComponent","reveal","checked","onChange","onTouched","form","controlRef","valid","getFormattedValue","onInput","$event","target","onFocus","blurred","setProperty","onBlur","formatValue","parseValue","innervalue","writeValue","registerOnChange","fn","registerOnTouched","setDisabledState","isDisabled","providers","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","ExistsValidator","values","debounced$","debounceTime","exists$","response","take","exists","validate","NG_ASYNC_VALIDATORS","MatchValidator","root","isReverse","NG_VALIDATORS","Attribute","UppercaseDirective","ngModelChange","EventEmitter","onInputChange","toUpperCase","emit","Output","HighlightPipe","text","query","encodeHTML","regExp","escapeRegexChars","safeToString","HttpResponseInterceptor","_router","_routeService","intercept","handle","throwError","JsonFormatterComponent","ngOnChanges","isObject","elementRef","removeChild","require","render","ViewChild","CustomAsyncPipe","changeDetector","subject","subscription","cachedValue","observableToValue","dispose","markForCheck","WrappedValue","wrap","_observableToValue","pure","ChangeDetectorRef","LabelService","cache","collectedKeys","labels$","emitter","getTranslation","labels","getLabel","defaultValue","shift","parseLabel","missingLabel","missingHandler","replacer","getKey","enumerable","writable","items","register","collectKeys","collect","LabelAsyncPipe","labelService","asyncPipe","LabelDirective","innerHTML","labelParams","LabelPipe","ref","LoggerComponent","EventDispatcherService","observe","MenuService","OnceService","zone","script","callback","Event","callbackName_1","callback$","Promise","reject","async","fromEvent","scripts","getElementsByTagName","parentNode","insertBefore","nextSibling","src","NgZone","AssetPipe","unshift","ImagePipe","queryString","imageType","image","PublicPipe","FacebookConfig","fields","scope","version","FacebookService","onceService","init","Error","storage","authResponse","protocol","FB","currentLang","xfbml","f","getLoginStatus","r","login","logout","getMe","l","api","tokenClient","user","facebookToken","GoogleTagManagerPageViewEvent","GoogleTagManagerConfig","GoogleTagManagerService","googleTagManager","once","dataLayer","dataLayer$","dataLayer_1","gtm.start","payload","runOutsideAngular","GoogleTagManagerComponent","useIframe","pageView","urlAfterRedirects","iframeUrl","GoogleConfig","cookiepolicy","fetch_basic_profile","ux_mode","GoogleService","google","Observable","gapi","profile","currentUser","getBasicProfile","getName","firstName","getGivenName","lastName","getFamilyName","picture","getImageUrl","getEmail","googleToken","access_token","auth2Instance","signin","isSignedIn","signOut","then","signed","getAuth2","auth2","auth2init","load","readAccessToken","getAuthResponse","code","signIn","client_id","clientId","getAuthInstance","MapboxService","PayPalConfig","PayPalService","paypal","paypal$","mergeMap","Button","getOptions","payment","actions","success","onAuthorize","execute","PayPalWidgetComponent","paypalService","paypalOptions","TrustPilotConfig","businessunitId","businessunitName","TrustPilotService","trustPilot","Trustpilot","Trustpilot$","TrustPilotWidgetOptions","styleHeight","styleWidth","theme","stars","newFromConfig","TrustPilotWidgetComponent","trustPilotOptions","children","loaded","loadFromElement","firstElementChild","RoutePipe","SlugService","slugs$","getSlugs","dictionary","mnemonic","SlugAsyncPipe","slugService","routePipe","slugs","SlugPipe","TranslatePipe","SafeStylePipe","sanitizer","bypassSecurityTrustStyle","DomSanitizer","SafeUrlPipe","bypassSecurityTrustResourceUrl","TrustPipe","bypassSecurityTrustHtml","ClickOutsideDirective","clickOutside","onClick","targetElement","contains","FancyboxDirective","$","addEventListener","fancybox","open","preventDefault","stopImmediatePropagation","LazyImagesDirective","onRegister","observer","disconnect","newIntersectionObserver","MutationObserver","mutations","attributes","characterData","childList","subtree","querySelectorAll","lazyImages","IntersectionObserver","isIntersecting","onAppearsInViewport","dataset","onImagePreload","addClass","srcset","backgroundSrc","setStyle","unobserve","img","Image","onload","onerror","Complete","Close","ModalCompleteEvent","ModalEventType","ModalCloseEvent","Modal","ModalData","ModalService","modals$","getInfos","modals","classList","removeClass","modal","pop","close","removeAll","prev","ModalContainerComponent","modalService","modalCount","className","doClose","doPrev","ModalViewComponent","destroy","useValue","resolvedInputs","ReflectiveInjector","fromResolvedProviders","modalContainer","parentInjector","insert","hostView","read","Éµ0","CoreModule","parentModule","forRoot","ngModule","CommonModule","HttpClientModule","FormsModule","ReactiveFormsModule","MarkdownModule","markedOptions","MarkedOptions","declarations","HTTP_INTERCEPTORS","useClass","Optional","SkipSelf","CoreService","Label","Document","DocumentIndex","MenuItem"],"mappings":"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","sourcesContent":["import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { Observable, of } from 'rxjs';\n\nconst TIMEOUT = 5 * 60 * 1000; // five minutes\n\n/*\nexport class StorageEvent extends Event {}\n\nexport class CookieStorageEvent extends StorageEvent { }\n\nexport class SessionStorageEvent extends StorageEvent { }\n\nexport class LocalStorageEvent extends StorageEvent { }\n*/\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class StorageService {\n\tpublic delete(name: string): void { }\n\tpublic exist(name: string): boolean { return false; }\n\tpublic get(name: string): any { return null; }\n\tpublic set(name: string, value: any, days?: number): void { }\n\tpublic on(): Observable<any> { return of(null); }\n\tpublic tryGet(): StorageService {\n\t\t// console.log('no StorageService available...');\n\t\treturn this;\n\t}\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class CookieStorageService implements StorageService {\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate storageService: StorageService,\n\t) { }\n\n\tpublic tryGet(): StorageService {\n\t\tif (this.isSupported()) {\n\t\t\t// console.log('CookieStorageService.supported');\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn this.storageService.tryGet();\n\t\t}\n\t}\n\n\tpublic delete(name: string): void {\n\t\tthis.setter(name, '', -1);\n\t}\n\n\tpublic exist(name: string): boolean {\n\t\treturn document.cookie.indexOf(';' + name + '=') !== -1 || document.cookie.indexOf(name + '=') === 0;\n\t}\n\n\tpublic get(name: string): any {\n\t\tconst cookieName = name + '=';\n\t\tconst ca = document.cookie.split(';');\n\t\tfor (let i = 0; i < ca.length; i++) {\n\t\t\tlet c = ca[i];\n\t\t\twhile (c.charAt(0) === ' ') {\n\t\t\t\tc = c.substring(1, c.length);\n\t\t\t}\n\t\t\tif (c.indexOf(cookieName) === 0) {\n\t\t\t\tconst value = c.substring(cookieName.length, c.length);\n\t\t\t\tlet model = null;\n\t\t\t\ttry {\n\t\t\t\t\tmodel = JSON.parse(decodeURIComponent(atob(value)));\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('Cookie.get.error parsing', name, e);\n\t\t\t\t}\n\t\t\t\treturn model;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic set(name: string, value: any, days?: number) {\n\t\ttry {\n\t\t\tlet cache = [];\n\t\t\tconst json = JSON.stringify(value, function (key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// throw (new Error('circular reference found, discard key'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\tcache = null;\n\t\t\tthis.setter(name, btoa(encodeURIComponent(json)), days);\n\t\t} catch (e) {\n\t\t\tconsole.log('CookieSet.error serializing', name, value, e);\n\t\t}\n\t}\n\n\tpublic on(): Observable<any> {\n\t\t// todo\n\t\tconst interval: number = 1000, timeout: number = TIMEOUT;\n\t\tlet i, elapsed: number = 0;\n\t\tfunction checkCookie() {\n\t\t\tif (elapsed > timeout) {\n\t\t\t\t// promise.reject('timeout');\n\t\t\t} else {\n\t\t\t\tconst c: any = this.get(name);\n\t\t\t\tif (c) {\n\t\t\t\t\t// promise.resolve(c);\n\t\t\t\t} else {\n\t\t\t\t\telapsed += interval;\n\t\t\t\t\ti = setTimeout(checkCookie, interval);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcheckCookie();\n\t\treturn of(null);\n\t}\n\n\tprivate setter(name: string, value: any, days?: number) {\n\t\tlet expires;\n\t\tif (days) {\n\t\t\tconst date = new Date();\n\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\t\texpires = '; expires=' + date.toUTCString();\n\t\t} else {\n\t\t\texpires = '';\n\t\t}\n\t\tdocument.cookie = name + '=' + value + expires + '; path=/';\n\t}\n\n\tprivate isSupported(): boolean {\n\t\treturn isPlatformBrowser(this.platformId);\n\t}\n\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SessionStorageService implements StorageService {\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate cookieStorageService: CookieStorageService,\n\t) { }\n\n\tpublic tryGet(): StorageService {\n\t\tif (this.isSupported()) {\n\t\t\t// console.log('SessionStorageService.supported');\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn this.cookieStorageService.tryGet();\n\t\t}\n\t}\n\n\tpublic delete(name: string): void {\n\t\twindow.sessionStorage.removeItem(name);\n\t}\n\n\tpublic exist(name: string): boolean {\n\t\treturn window.sessionStorage[name] !== undefined;\n\t}\n\n\tpublic get(name: string): any {\n\t\tlet value = null;\n\t\tif (window.sessionStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.sessionStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('SessionStorage.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tpublic on(): Observable<any> {\n\t\t/*\n\t\treturn $promise(function (promise) {\n\t\t\tconst timeout = TIMEOUT;\n\t\t\tlet i;\n\t\t\tfunction storageEvent(e) {\n\t\t\t\tif (i) {\n\t\t\t\t\tclearTimeout(i);\n\t\t\t\t}\n\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlet value = JSON.parse(e.originalEvent.newValue);\n\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('SessionStorage.on.error parsing', name, error);\n\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// return fromEvent(window, 'storage');\n\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\ti = setTimeout(function () {\n\t\t\t\tpromise.reject('timeout');\n\t\t\t}, timeout);\n\t\t});\n\t\t*/\n\t\treturn of(null);\n\t}\n\n\tpublic set(name: string, value: any, days?: number): void {\n\t\ttry {\n\t\t\tlet cache = [];\n\t\t\tconst json = JSON.stringify(value, function (key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// throw (new Error('circular reference found, discard key'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\tcache = null;\n\t\t\twindow.sessionStorage.setItem(name, json);\n\t\t} catch (e) {\n\t\t\tconsole.log('SessionStorage.set.error serializing', name, value, e);\n\t\t}\n\t}\n\n\tprivate isSupported(): boolean {\n\t\tlet supported: boolean = false;\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\ttry {\n\t\t\t\tsupported = 'sessionStorage' in window && window.sessionStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.sessionStorage.setItem('test', '1');\n\t\t\t\t\twindow.sessionStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t}\n\t\treturn supported;\n\t}\n\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LocalStorageService implements StorageService {\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate cookieStorageService: CookieStorageService,\n\t) { }\n\n\tpublic tryGet(): StorageService {\n\t\tif (this.isSupported()) {\n\t\t\t// console.log('LocalStorageService.supported');\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn this.cookieStorageService.tryGet();\n\t\t}\n\t}\n\n\tpublic delete(name: string): void {\n\t\twindow.localStorage.removeItem(name);\n\t}\n\n\tpublic exist(name: string): boolean {\n\t\treturn window.localStorage[name] !== undefined;\n\t}\n\n\tpublic get(name: string): any {\n\t\tlet value = null;\n\t\tif (window.localStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorage.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tpublic on(): Observable<any> {\n\t\t/*\n\t\treturn $promise(function (promise) {\n\t\t\tconst timeout = TIMEOUT;\n\t\t\tlet i;\n\t\t\tfunction storageEvent(e) {\n\t\t\t\tif (i) {\n\t\t\t\t\tclearTimeout(i);\n\t\t\t\t}\n\t\t\t\tif (e.originalEvent.key === name) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlet value = JSON.parse(e.originalEvent.newValue);\n\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('LocalStorage.on.error parsing', name, error);\n\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// return fromEvent(window, 'storage');\n\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\ti = setTimeout(function () {\n\t\t\t\tpromise.reject('timeout');\n\t\t\t}, timeout);\n\t\t});\n\t\t*/\n\t\treturn of(null);\n\t}\n\n\tpublic set(name: string, value: any, days?: number): void {\n\t\ttry {\n\t\t\tlet cache = [];\n\t\t\tconst json = JSON.stringify(value, function (key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// throw (new Error('circular reference found, discard key'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\tcache = null;\n\t\t\twindow.localStorage.setItem(name, json);\n\t\t} catch (e) {\n\t\t\tconsole.log('LocalStorage.set.error serializing', name, value, e);\n\t\t}\n\t}\n\n\tprivate isSupported(): boolean {\n\t\tlet supported: boolean = false;\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\ttry {\n\t\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\t\tif (supported) {\n\t\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t\t} else {\n\t\t\t\t\tsupported = false;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t}\n\t\treturn supported;\n\t}\n\n}\n","import { HttpRequest } from '@angular/common/http';\nimport { Inject, Injectable, Injector, PLATFORM_ID } from '@angular/core';\nimport { LocalStorageService } from '../storage/storage.service';\n\nexport class AuthToken {\n\tconstructor(\n\t\tpublic accessToken: string,\n\t\tpublic expiresIn: number = 0\n\t) { }\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class AuthService {\n\n\tprivate cachedRequests: Array<HttpRequest<any>> = [];\n\tprivate paths: string[] = [];\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate injector: Injector,\n\t\tprivate localStorageService: LocalStorageService,\n\t) { }\n\n\tsetToken(authToken: AuthToken): void {\n\t\tthis.localStorageService.set('authToken', authToken);\n\t\tthis.retryFailedRequests();\n\t}\n\n\tgetToken(): AuthToken {\n\t\treturn this.localStorageService.get('authToken') as AuthToken;\n\t}\n\n\tgetFakeToken(): AuthToken {\n\t\treturn new AuthToken('fakeToken');\n\t}\n\n\tisValid(authToken: AuthToken): boolean {\n\t\t// return a boolean reflecting whether or not the token is expired\n\t\treturn authToken && (authToken.expiresIn > Date.now() || authToken.expiresIn === 0);\n\t}\n\n\tisAuthenticated(): boolean {\n\t\tconst authToken = this.getToken();\n\t\treturn this.isValid(authToken);\n\t}\n\n\tcollectFailedRequest(request): void {\n\t\tthis.cachedRequests.push(request);\n\t}\n\n\tretryFailedRequests(): void {\n\t\t// this method can be called after the token is refreshed\n\t\t// console.log('AuthService.retryFailedRequests');\n\t\t// retry the requests.\n\t}\n\n}\n","import { InjectionToken, Type } from '@angular/core';\nimport { PageComponent } from '../pages/page.component';\nimport { Pages } from '../pages/pages';\nimport { FacebookConfig } from '../plugins/facebook/facebook.service';\nimport { GoogleTagManagerConfig } from '../plugins/google/google-tag-manager.service';\nimport { GoogleConfig } from '../plugins/google/google.service';\nimport { MapboxConfig } from '../plugins/mapbox/mapbox.service';\nimport { PayPalConfig } from '../plugins/paypal/paypal.service';\nimport { TrustPilotConfig } from '../plugins/trustpilot/trustpilot.service';\n\nexport enum AuthStrategy {\n\tBearer = 0,\n\tCookie = 1,\n}\n\nexport class Language {\n\tid?: number;\n\tname?: string;\n\tlang?: string;\n}\n\nexport class CoreConfigPlugins {\n\tfacebook?: FacebookConfig;\n\tgoogle?: GoogleConfig;\n\tgoogleTagManager?: GoogleTagManagerConfig;\n\tmapbox?: MapboxConfig;\n\tpaypal?: PayPalConfig;\n\ttrustPilot?: TrustPilotConfig;\n\n\tconstructor(options?: CoreConfigPlugins) {\n\t\tconsole.log('CoreConfigPlugins', options);\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class CoreTransitionConfig {\n\tappId?: string;\n\n\tconstructor(options?: CoreTransitionConfig) {\n\t\tconsole.log('CoreTransitionConfig', options);\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class CorePrebootConfig {\n\tappRoot?: string;\n\n\tconstructor(options?: CorePrebootConfig) {\n\t\tconsole.log('CorePrebootConfig', options);\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class CoreConfig {\n\tassets?: string = '';\n\tauthStrategy?: AuthStrategy = AuthStrategy.Cookie;\n\tdefaultLanguage?: string = 'it';\n\tdefaultMarket?: string = 'it';\n\tdefaultPage?: Type<PageComponent>;\n\teditor?: boolean;\n\tenableTracing?: boolean;\n\tlanguages?: Language[] = [{ id: 1, name: 'Italiano', lang: 'it' }];\n\tnotFoundPage?: Type<PageComponent>;\n\torigin?: string = '';\n\tpages?: Pages = {};\n\tplugins?: CoreConfigPlugins;\n\tpreboot?: CorePrebootConfig;\n\tproduction?: boolean = false;\n\tpublic?: string = '';\n\ttransition?: CoreTransitionConfig;\n\turlStrategy?: string = '';\n\tuseHash?: boolean = true;\n\tuseLang?: boolean = false;\n\tuseMarket?: boolean = false;\n\tuseServiceWorker?: boolean;\n\n\tconstructor(options?: CoreConfig) {\n\t\tconsole.log('CoreConfig', options);\n\t\tif (options) {\n\t\t\tthis.pages = options.pages || {};\n\t\t\tthis.plugins = new CoreConfigPlugins(options.plugins);\n\t\t\tthis.preboot = new CorePrebootConfig(options.preboot);\n\t\t\tthis.transition = new CoreTransitionConfig(options.transition);\n\t\t\tthis.defaultPage = options.defaultPage;\n\t\t\tthis.notFoundPage = options.notFoundPage;\n\t\t} else {\n\t\t\tthis.plugins = new CoreConfigPlugins();\n\t\t\tthis.preboot = new CorePrebootConfig();\n\t\t\tthis.transition = new CoreTransitionConfig();\n\t\t}\n\t}\n}\n\nexport const CORE_CONFIG = new InjectionToken<CoreConfig>('core.config');\n","\nimport { Inject, Injectable } from '@angular/core';\nimport { CoreConfig, CORE_CONFIG } from './core.config';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ConfigService {\n\n\tpublic options: CoreConfig;\n\n\tconstructor(\n\t\t@Inject(CORE_CONFIG) options: CoreConfig\n\t) {\n\t\tconsole.log('ConfigService', options);\n\t\toptions = options || {};\n\t\t// options.defaultPage = (options.defaultPage || PageNotFoundComponent) as Type<PageComponent>;\n\t\t// options.notFoundPage = (options.notFoundPage || PageNotFoundComponent) as Type<PageComponent>;\n\t\tthis.options = new CoreConfig(options);\n\t}\n\n}\n","import { AfterContentChecked, Directive, ElementRef, Input, Renderer2, TemplateRef, ViewContainerRef } from '@angular/core';\n\n@Directive({\n\tselector: '[default]',\n})\nexport class DefaultContentDirective implements AfterContentChecked {\n\n\t@Input() default: TemplateRef<any>;\n\tprivate element: HTMLElement;\n\tprivate hasContent = true;\n\n\tconstructor(\n\t\telement: ElementRef,\n\t\tprivate container: ViewContainerRef,\n\t\tprivate renderer: Renderer2) {\n\t\tthis.element = element.nativeElement;\n\t}\n\n\tngAfterContentChecked(): void {\n\t\tlet hasContent = false;\n\t\tconsole.log('DefaultContentDirective', this.element.childNodes);\n\t\tfor (let i = this.element.childNodes.length - 1; i >= 0; --i) {\n\t\t\tconst node = this.element.childNodes[i];\n\t\t\tif (node.nodeType === 1 || node.nodeType === 3) {\n\t\t\t\thasContent = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (hasContent !== this.hasContent) {\n\t\t\tthis.hasContent = hasContent;\n\t\t\tif (hasContent) {\n\t\t\t\t// this.renderer.removeClass(this.element, 'is-empty');\n\t\t\t\tthis.container.clear();\n\t\t\t} else {\n\t\t\t\t// this.renderer.addClass(this.element, 'is-empty');\n\t\t\t\tthis.container.createEmbeddedView(this.default);\n\t\t\t}\n\t\t}\n\t}\n\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n\tselector: 'ws-core',\n\ttemplate: `\n    <span class=\"core__version\">core version 0.1.0</span>\n  `,\n\tstyles: []\n})\nexport class CoreComponent implements OnInit {\n\n\tconstructor() { }\n\n\tngOnInit() {\n\t}\n\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","\nimport { Component, OnDestroy } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n@Component({\n\ttemplate: ''\n})\nexport class DisposableComponent implements OnDestroy {\n\n\tprotected unsubscribe: any = new Subject();\n\n\tngOnDestroy() {\n\t\tthis.unsubscribe.next();\n\t\tthis.unsubscribe.complete();\n\t\t// console.log('DisposableComponent.ngOnDestroy', this);\n\t}\n\n}\n","\nimport { Location } from '@angular/common';\nimport { Injectable, Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n\tname: 'segment',\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SegmentPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate location: Location\n\t) { }\n\n\ttransform(segments: any[] | string): any[] {\n\t\tsegments = segments != null ? (Array.isArray(segments) ? segments : segments.split('/')) : [];\n\t\tlet path: string = segments.join('/');\n\t\tpath = this.location.normalize(path);\n\t\tif (path.indexOf('/') !== 0) {\n\t\t\tpath = `/${path}`;\n\t\t}\n\t\tsegments = path.split('/');\n\t\treturn segments;\n\t}\n\n}\n","import { HttpErrorResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { ConfigService } from '../config/config.service';\n\nexport class LoggerError extends HttpErrorResponse {\n\tbody?: any;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class Logger {\n\n\thttpError: LoggerError;\n\tlogs: string[] = [];\n\n\tconstructor(\n\t\tprivate configService: ConfigService,\n\t) {\n\t\t//\n\t}\n\n\trequest(...args: any[]) {\n\t\tif (!this.configService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\t// console.log.apply(this, ['%c %s', 'background: #dddddd; color: #111'].concat(args));\n\t\t}\n\t}\n\n\tlog(...args: any[]) {\n\t\tif (!this.configService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\tconsole.log.apply(this, ['%c%s', 'background: #1976d2; color: #fff; border-radius: 3px; padding: 4px 8px; margin-bottom: 4px;'].concat(args));\n\t\t}\n\t}\n\n\twarn(...args: any[]) {\n\t\tif (!this.configService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\tconsole.log.apply(this, ['%c%s', 'background: #ff5500; color: #fff'].concat(args));\n\t\t}\n\t}\n\n\terror(...args: any[]) {\n\t\tif (!this.configService.options.production) {\n\t\t\tconst s = args.join(', ');\n\t\t\tthis.logs.push(s);\n\t\t\tconsole.error.apply(console, args);\n\t\t}\n\t}\n\n\thttp(error: HttpErrorResponse) {\n\t\tthis.httpError = error;\n\t\tif (!this.configService.options.production) {\n\t\t\tthis.logs.push(error.message);\n\t\t}\n\t\tconsole.warn('Logger.http.error', error.status, error.statusText, error.url);\n\t}\n\n\tclear() {\n\t\tthis.httpError = null;\n\t\tthis.logs = [];\n\t}\n}\n","import { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable, Injector, PLATFORM_ID } from '@angular/core';\nimport { makeStateKey, StateKey, TransferState } from '@angular/platform-browser';\nimport { Observable, of } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport { ConfigService } from '../config/config.service';\nimport { CoreConfig } from '../config/core.config';\nimport { Logger } from '../logger/logger';\nimport { Identity } from '../models/identity';\n\nexport class ApiRequestOptions {\n\theaders?: HttpHeaders;\n\tparams?: HttpParams;\n\tconstructor(options?: {}) {\n\t\tthis.headers = new HttpHeaders({\n\t\t\t'Content-Type': 'application/json'\n\t\t});\n\t\tthis.params = options ? new HttpParams(options) : null;\n\t}\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ApiService<T extends Identity> {\n\n\tget collection(): string {\n\t\treturn '/api';\n\t}\n\n\tprivate _logger: Logger;\n\tget logger(): Logger {\n\t\tif (!this._logger) {\n\t\t\tthis._logger = this.injector.get(Logger);\n\t\t}\n\t\treturn this._logger;\n\t}\n\n\tprivate _http: HttpClient;\n\tget http(): HttpClient {\n\t\tif (!this._http) {\n\t\t\tthis._http = this.injector.get(HttpClient);\n\t\t}\n\t\treturn this._http;\n\t}\n\n\tprivate _state: TransferState;\n\tget state(): TransferState {\n\t\tif (!this._state) {\n\t\t\tthis._state = this.injector.get(TransferState);\n\t\t}\n\t\treturn this._state;\n\t}\n\n\tprivate _platformId: string;\n\tget platformId(): string {\n\t\tif (!this._platformId) {\n\t\t\tthis._platformId = this.injector.get<string>(PLATFORM_ID);\n\t\t}\n\t\treturn this._platformId;\n\t}\n\n\tprivate _config: CoreConfig;\n\tget config(): CoreConfig {\n\t\tif (!this._config) {\n\t\t\tthis._config = this.injector.get(ConfigService).options;\n\t\t}\n\t\treturn this._config;\n\t}\n\n\tprivate _origin: string;\n\tget origin(): string {\n\t\tif (!this._origin) {\n\t\t\tthis._origin = this.config.origin;\n\t\t}\n\t\treturn this._origin;\n\t}\n\n\tget url(): string {\n\t\tlet base: string = this.origin;\n\t\tconst collection = this.collection.toLowerCase();\n\t\tif (collection.indexOf('http') === 0) {\n\t\t\tbase = '';\n\t\t}\n\t\treturn `${base}${collection}`;\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector\n\t) { }\n\n\tgetUrl(method: string = ''): string {\n\t\treturn `${this.url}${method}`;\n\t}\n\n\tget(first?: string | {}, second?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst params: {} = (typeof first === 'object' ? first : second);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.get<T>(url, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tpost(first: string | {}, second?: {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: {} = (typeof first === 'object' ? first : second);\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.post<T>(url, model, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tput(first: string | T, second?: T | {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: T = (typeof first === 'object' ? first : second) as T;\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.put<T>(url, model, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tpatch(first: string | T, second?: T | {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: T = (typeof first === 'object' ? first : second) as T;\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.patch<T>(url, model, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\tdelete(first: string | T | number, second?: T | number | {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst identity: T | number = (typeof first !== 'string' ? first : second) as T | number;\n\t\tconst id = identity ? (typeof identity === 'number' ? identity : identity.id) : null;\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = id !== null ? this.getUrl(`${method}/${id}`) : this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\treturn this.http.delete<T[]>(url, options).pipe(\n\t\t\ttap(x => this.logger.request(url)),\n\t\t);\n\t}\n\n\ttoCamelCase(input: any): any {\n\t\tlet output, key, keyCamelCase, value;\n\t\tif (input instanceof Array) {\n\t\t\treturn input.map((value: any) => {\n\t\t\t\tif (typeof value === 'object') {\n\t\t\t\t\tvalue = this.toCamelCase(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t} else {\n\t\t\toutput = {};\n\t\t\tfor (key in input) {\n\t\t\t\tif (input.hasOwnProperty(key)) {\n\t\t\t\t\tkeyCamelCase = (key.charAt(0).toLowerCase() + key.slice(1) || key).toString();\n\t\t\t\t\tvalue = input[key];\n\t\t\t\t\tif (value instanceof Array || (value !== null && value.constructor === Object)) {\n\t\t\t\t\t\tvalue = this.toCamelCase(value);\n\t\t\t\t\t}\n\t\t\t\t\toutput[keyCamelCase] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t// TRANSFER STATE\n\n\tgetStateKey(url: string, model: {}): StateKey<T> {\n\t\tconst flatMap = (s: string, x: any) => {\n\t\t\tif (typeof x === 'number') {\n\t\t\t\ts += x.toString();\n\t\t\t} else if (typeof x === 'string') {\n\t\t\t\ts += x.substr(0, 10);\n\t\t\t} else if (x && typeof x === 'object') {\n\t\t\t\ts += '_' + Object.keys(x).map(k => k + '_' + flatMap('', x[k])).join('_');\n\t\t\t}\n\t\t\treturn s;\n\t\t};\n\t\turl = flatMap(url, model);\n\t\t// console.log('ApiService.getStateKey.url', url);\n\t\tconst key: string = url.replace(/(\\W)/gm, '_');\n\t\t// this.logger.log('ApiService.getStateKey.key', key);\n\t\treturn makeStateKey(key);\n\t}\n\n\tstateGet(first?: string | {}, second?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst params: {} = (typeof first === 'object' ? first : second);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\tconst stateKey = this.getStateKey(url, params);\n\t\tif (isPlatformBrowser(this.platformId) && this.state.hasKey(stateKey)) {\n\t\t\tconst cached = this.state.get(stateKey, null);\n\t\t\tthis.state.remove(stateKey);\n\t\t\treturn of(cached);\n\t\t} else {\n\t\t\treturn this.http.get<T>(url, options).pipe(\n\t\t\t\ttap(x => {\n\t\t\t\t\tif (isPlatformServer(this.platformId)) {\n\t\t\t\t\t\tthis.state.onSerialize(stateKey, () => x);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\n\tstatePost(first: string | {}, second?: {}, third?: {}): Observable<any> {\n\t\tconst method: string = (typeof first === 'string' ? first : '');\n\t\tconst model: {} = (typeof first === 'object' ? first : second);\n\t\tconst params: {} = (typeof second === 'object' ? second : third);\n\t\tconst url: string = this.getUrl(method);\n\t\tconst options = new ApiRequestOptions(params);\n\t\tconst stateKey = this.getStateKey(url, model);\n\t\tif (isPlatformBrowser(this.platformId) && this.state.hasKey(stateKey)) {\n\t\t\tconst cached = this.state.get(stateKey, null);\n\t\t\tthis.state.remove(stateKey);\n\t\t\treturn of(cached);\n\t\t} else {\n\t\t\treturn this.http.post<T>(url, model, options).pipe(\n\t\t\t\ttap(x => {\n\t\t\t\t\tif (isPlatformServer(this.platformId)) {\n\t\t\t\t\t\tthis.state.onSerialize(stateKey, () => x);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { ApiService } from '../api/api.service';\n\nexport class Translate {\n\tid: string;\n\tvalue?: string;\n\tdefaultValue?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class TranslateService extends ApiService<Translate>  {\n\n\tget collection(): string {\n\t\treturn '/api/translate';\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector\n\t) {\n\t\tsuper(injector);\n\t}\n\n\tpublic use(lang: string) {\n\n\t}\n\n\tpublic setDefaultLang(lang: string) {\n\n\t}\n\n\tpublic addLangs(lang: string[]) {\n\n\t}\n\n\tpublic getBrowserLang(): string {\n\t\treturn 'it';\n\t}\n}\n","\n\nimport { isPlatformBrowser, isPlatformServer, Location } from '@angular/common';\nimport { ComponentFactory, ComponentFactoryResolver, Inject, Injectable, Injector, PLATFORM_ID } from '@angular/core';\nimport { ActivatedRoute, ActivationEnd, NavigationStart, Params, Router } from '@angular/router';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { concatMap, distinctUntilChanged, filter, map, switchMap, tap } from 'rxjs/operators';\nimport { ConfigService } from '../config/config.service';\nimport { Page } from '../pages/page';\nimport { PageComponent } from '../pages/page.component';\nimport { SegmentPipe } from '../pipes/segment.pipe';\nimport { TranslateService } from '../translate/translate.service';\n\ndeclare const Buffer;\ndeclare const process;\n\n// @dynamic\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class RouteService {\n\n\tstatic startTime: number;\n\tstatic endTime: number;\n\tprivate urlStrategy: string;\n\tprivate _language: any = new BehaviorSubject({});\n\tpublic readonly language: Observable<any> = this._language.asObservable();\n\tprivate _languages: BehaviorSubject<Array<any>> = new BehaviorSubject([]);\n\tpublic readonly languages: Observable<any[]> = this._languages.asObservable();\n\tprivate _lang: string;\n\tprivate path: string;\n\tpublic page: Page;\n\tpublic params: Observable<Params>;\n\tpublic queryParams: Observable<Params>;\n\tprivate busy: boolean;\n\tpublic currentMarket: string;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate injector: Injector,\n\t\tprivate translateService: TranslateService,\n\t\tprivate location: Location,\n\t\tprivate route: ActivatedRoute,\n\t\tprivate router: Router,\n\t\tprivate segment: SegmentPipe,\n\t\tprivate componentFactoryResolver: ComponentFactoryResolver\n\t) {\n\t\tthis.urlStrategy = this.configService.options.urlStrategy;\n\t\tthis._languages.next(this.configService.options.languages);\n\t\tthis.currentMarket = this.configService.options.defaultMarket;\n\t\tthis.setLanguages();\n\t\tif (this.configService.options.useLang || this.configService.options.useMarket) {\n\t\t\tthis.subscribeToRouter();\n\t\t}\n\t}\n\n\tprivate get lang(): string {\n\t\treturn this._lang;\n\t}\n\n\tprivate set lang(lang: string) {\n\t\tif (lang !== this._lang) {\n\t\t\tthis._lang = lang;\n\t\t\tconst language = this._languages.getValue().find(x => x.lang === lang);\n\t\t\tthis._language.next(language);\n\t\t\tthis.translateService.use(lang);\n\t\t\t// console.log('RouteService.set lang', lang, this.configService.options.useLang);\n\t\t\tif (this.configService.options.useLang) {\n\t\t\t\tconst _lang: string = this._lang;\n\t\t\t\tlet path = this.location.path();\n\t\t\t\tif (path.indexOf(`/${_lang}`) === 0) {\n\t\t\t\t\tpath = path.replace(`/${_lang}`, `/${lang}`);\n\t\t\t\t} else if (path.indexOf(`/${lang}`) !== 0) {\n\t\t\t\t\tpath = `/${lang}` + path;\n\t\t\t\t}\n\t\t\t\tthis.path = path;\n\t\t\t\t// const langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get currentLang(): string {\n\t\treturn this._lang;\n\t}\n\n\tpublic pageParams$: BehaviorSubject<Params> = new BehaviorSubject({});\n\tpublic getPageParams(): Observable<Params> {\n\t\t// console.log('RouteService.getPageParams', this.router.url);\n\t\treturn this.route.queryParams.pipe(\n\t\t\tdistinctUntilChanged(),\n\t\t\tswitchMap(params => {\n\t\t\t\t// console.log(params);\n\t\t\t\tconst parsed = this.parseParams(params);\n\t\t\t\tthis.pageParams$.next(parsed);\n\t\t\t\treturn of(parsed);\n\t\t\t}),\n\t\t\t// tap(params => console.log('RouteService.getPageParams', params)),\n\t\t);\n\t}\n\n\tpublic parseParams(params: any): any {\n\t\tconst parsed = {};\n\t\tObject.keys(params).forEach(k => parsed[k] = this.parse(params[k]));\n\t\t/*\n\t\tfor (const key in params) {\n\t\t\tif (typeof (params[key]) === 'string') {\n\t\t\t\tparsed[key] = this.parse(params[key]);\n\t\t\t} else {\n\t\t\t\tparsed[key] = params[key];\n\t\t\t}\n\t\t}\n\t\t*/\n\t\treturn parsed;\n\t}\n\n\tpublic serializeParams(params: any) {\n\t\tconst serialized = {};\n\t\tObject.keys(params).forEach(k => serialized[k] = this.serialize(params[k]));\n\t\treturn serialized;\n\t}\n\n\tpublic parse(base64) {\n\t\ttry {\n\t\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\t\treturn JSON.parse(window.atob(base64));\n\t\t\t} else {\n\t\t\t\treturn JSON.parse(Buffer.from(base64, 'base64').toString('ascii'));\n\t\t\t}\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tpublic serialize(object) {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\treturn window.btoa(JSON.stringify(object));\n\t\t} else {\n\t\t\treturn Buffer.from(JSON.stringify(object), 'ascii').toString('base64');\n\t\t}\n\t}\n\n\tpublic getId(): number {\n\t\treturn +this.route.snapshot.paramMap.get('id');\n\t}\n\n\tpublic getSlug(): string {\n\t\treturn this.route.snapshot.paramMap.get('slug');\n\t}\n\n\tpublic toRoute(data: any[] | string): any[] {\n\t\tconst segments = this.segment.transform(data);\n\t\tif (this.configService.options.useMarket) {\n\t\t\tconst market: string = this.currentMarket;\n\t\t\tconst marketIndex = this.urlStrategy.split('/').indexOf(':market');\n\t\t\tsegments.splice(marketIndex, 0, market);\n\t\t}\n\t\tif (this.configService.options.useLang) {\n\t\t\tconst lang: string = this._lang;\n\t\t\tconst langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\tsegments.splice(langIndex, 0, lang);\n\t\t}\n\t\t// console.log('RouteService.toRoute', segments);\n\t\treturn segments;\n\t}\n\n\tpublic toSlug(data: any[] | string): any[] {\n\t\tconst segments = this.segment.transform(data);\n\t\tlet paths = segments.filter(x => {\n\t\t\treturn typeof x === 'string';\n\t\t});\n\t\tconst datas = segments.filter(x => {\n\t\t\treturn typeof x !== 'string';\n\t\t});\n\t\tif (this.configService.options.useMarket) {\n\t\t\tconst marketIndex = this.urlStrategy.split('/').indexOf(':market');\n\t\t\tif (paths.length > marketIndex) {\n\t\t\t\tpaths[marketIndex] = '*';\n\t\t\t}\n\t\t}\n\t\tif (this.configService.options.useLang) {\n\t\t\tconst langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\tif (paths.length > langIndex) {\n\t\t\t\tpaths[langIndex] = '*';\n\t\t\t}\n\t\t}\n\t\tpaths = paths.join('/').replace(/\\/\\*/gi, '').split('/');\n\t\t// console.log('RouteService.toSlug', data, paths);\n\t\treturn paths.concat(datas);\n\t}\n\n\tpublic toParams(data: any): any {\n\t\treturn {\n\t\t\tdata: window.btoa(JSON.stringify(data))\n\t\t};\n\t}\n\n\tpublic toData(params: any): any {\n\t\tif (params && params.data) {\n\t\t\treturn JSON.parse(window.atob(params.data));\n\t\t}\n\t}\n\n\tpublic getParams(): Observable<ComponentFactory<PageComponent>> {\n\t\treturn this.router.events.pipe(\n\t\t\tfilter(event => event instanceof ActivationEnd),\n\t\t\tmap(() => this.route),\n\t\t\tdistinctUntilChanged(),\n\t\t\tmap(route => route.firstChild),\n\t\t\tswitchMap(route => route.params),\n\t\t\t/*\n\t\t\ttap((params) => {\n\t\t\t\t// console.log('getParams', params);\n\t\t\t}),\n\t\t\t*/\n\t\t\tconcatMap(x => {\n\t\t\t\treturn of(this.toData(x));\n\t\t\t})\n\t\t);\n\t}\n\n\tpublic _unused_getPageComponentFactory(): Observable<ComponentFactory<PageComponent>> {\n\t\treturn this.router.events.pipe(\n\t\t\tfilter(event => event instanceof ActivationEnd),\n\t\t\t/*\n\t\t\ttap((event) => {\n\t\t\t\t// console.log('ActivationEnd', event);\n\t\t\t}),\n\t\t\t*/\n\t\t\tmap(() => this.route),\n\t\t\tdistinctUntilChanged(),\n\t\t\tmap(route => route.firstChild),\n\t\t\ttap((route) => {\n\t\t\t\tthis.params = route.params.pipe(\n\t\t\t\t\tconcatMap(x => {\n\t\t\t\t\t\treturn of(this.toData(x));\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tthis.queryParams = route.queryParams.pipe(\n\t\t\t\t\t// tap(x => console.log('queryParams', x)),\n\t\t\t\t\tconcatMap(x => {\n\t\t\t\t\t\treturn of(this.toData(x));\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\t// console.log('params', this.route.params);\n\t\t\t}),\n\t\t\tswitchMap(route => route.data),\n\t\t\tmap((data): ComponentFactory<PageComponent> => {\n\t\t\t\tif (data.pageResolver) {\n\t\t\t\t\tthis.page = data.pageResolver.page;\n\t\t\t\t\tconst factory: ComponentFactory<PageComponent> = this.componentFactoryResolver.resolveComponentFactory(data.pageResolver.component);\n\t\t\t\t\treturn factory;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tpublic setLanguage(lang: string, silent?: boolean) {\n\t\tthis.lang = lang;\n\t\tif (this.configService.options.useLang && this.path) {\n\t\t\t// console.log('RouteService.setLanguage', this.path, this._lang, lang, silent);\n\t\t\tif (silent) {\n\t\t\t\tthis.location.replaceState(this.path);\n\t\t\t} else {\n\t\t\t\tthis.router.navigate([this.path]);\n\t\t\t}\n\t\t}\n\t}\n\n\t// PRIVATE METHODS\n\n\tprivate setLanguages() {\n\t\tthis.translateService.addLangs(this.configService.options.languages ? this.configService.options.languages.map(x => x.lang) : []);\n\t\tthis.translateService.setDefaultLang(this.configService.options.defaultLanguage);\n\t\t// this.setLanguage(this.detectLanguage(), true);\n\t\tthis.setLanguage(this.configService.options.defaultLanguage, true);\n\t\t/*\n\t\tthis.translateService.onLangChange.subscribe((e: LangChangeEvent) => {\n\t\t\t// console.log('RouteService.onLangChange', e);\n\t\t});\n\t\t*/\n\t}\n\n\tprivate subscribeToRouter() {\n\t\tthis.router.events.pipe(\n\t\t\tfilter(event => event instanceof NavigationStart)\n\t\t).subscribe((event: NavigationStart) => {\n\t\t\tconst location = this.location.normalize(event.url).split('/');\n\t\t\tif (this.configService.options.useMarket) {\n\t\t\t\tconst marketIndex = this.urlStrategy.split('/').indexOf(':market');\n\t\t\t\tconst market = location[marketIndex];\n\t\t\t\tif (market !== this.currentMarket) {\n\t\t\t\t\tthis.currentMarket = market;\n\t\t\t\t\t// console.log('RouteService.setMarket', market, event.url);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.configService.options.useLang) {\n\t\t\t\tconst langIndex = this.urlStrategy.split('/').indexOf(':lang');\n\t\t\t\tconst lang = location[langIndex];\n\t\t\t\tif (lang !== this._lang) {\n\t\t\t\t\tconst language = this._languages.getValue().find(x => x.lang === lang);\n\t\t\t\t\tthis._language.next(language);\n\t\t\t\t\tthis.translateService.use(lang);\n\t\t\t\t\t// console.log('RouteService.setLang', lang, this._lang, langIndex, location, event.url);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate detectLanguage(): string {\n\t\tlet acceptLanguage: string = null;\n\t\tif (isPlatformServer(this.platformId)) {\n\t\t\t/*\n\t\t\t// server side express engine\n\t\t\tapp.engine('html',  (_, options, callback) => {\n\t\t\t\tlet engine = ngExpressEngine({\n\t\t\t\t\tbootstrap: ServerAppModule,\n\t\t\t\t\tproviders: [ { provide: 'request', useFactory: () => options.req } ]\n\t\t\t\t});\n\t\t\t\tengine(_, options, callback)\n\t\t\t})\n\t\t\t*/\n\t\t\tconst request = this.injector.get('request');\n\t\t\tif (request) {\n\t\t\t\tacceptLanguage = request.headers['accept-language'];\n\t\t\t\tconst languages: string[] = acceptLanguage.match(/[a-zA-Z\\-]{2,10}/g) || [];\n\t\t\t\tif (languages.length > 0) {\n\t\t\t\t\tacceptLanguage = languages[0].split('-')[0];\n\t\t\t\t} else {\n\t\t\t\t\tacceptLanguage = null;\n\t\t\t\t}\n\t\t\t\t// console.log('request', request, 'acceptLanguage', acceptLanguage);\n\t\t\t}\n\t\t\t// console.log('RouteService.isPlatformServer', this.platformId, acceptLanguage);\n\t\t} else if (isPlatformBrowser(this.platformId)) {\n\t\t\tacceptLanguage = this.translateService.getBrowserLang();\n\t\t\t// console.log('RouteService.isPlatformBrowser', this.platformId, acceptLanguage);\n\t\t}\n\t\tlet detectedLanguage: string = this.configService.options.defaultLanguage;\n\t\tconst regexp: RegExp = new RegExp(`(${this.configService.options.languages ? this.configService.options.languages.map(x => x.lang).join('|') : ''})`, 'gi');\n\t\tconst match = (acceptLanguage || '').match(regexp);\n\t\tdetectedLanguage = match ? match[0] : detectedLanguage;\n\t\t// console.log('RouteService.detectLanguage', detectedLanguage);\n\t\treturn detectedLanguage;\n\t}\n\n\tpublic getTime() {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\treturn (performance || Date).now();\n\t\t} else {\n\t\t\tconst time = process.hrtime();\n\t\t\treturn (time[0] * 1e9 + time[1]) / 1e6;\n\t\t}\n\t}\n\n}\n","\nimport { isPlatformBrowser } from '@angular/common';\nimport { Component, Injector, Input, PLATFORM_ID } from '@angular/core';\nimport { NavigationEnd, Params, Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { RouteService } from '../routes/route.service';\nimport { Page } from './page';\n\nexport interface PageInit {\n\tPageInit(): void;\n}\n\n@Component({\n\tselector: 'ws-page',\n\ttemplate: `<h1>I'm a default view!</h1>`,\n})\n\nexport class PageComponent extends DisposableComponent {\n\n\t@Input() page: Page;\n\t@Input() params: Observable<Params>;\n\t@Input() queryParams: Observable<Params>;\n\n\tget platformId(): string {\n\t\treturn this.injector.get(PLATFORM_ID) as string;\n\t}\n\n\tget routeService(): RouteService {\n\t\treturn this.injector.get(RouteService);\n\t}\n\n\tget router(): Router {\n\t\treturn this.injector.get(Router);\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector,\n\t) {\n\t\tsuper();\n\t\tthis.scrollToTop();\n\t}\n\n\t// !!! Scroll to top on page change\n\tprivate scrollToTop(): void {\n\t\t// !!! PLATFORM_ID dependancy manually activated\n\t\t// const platformId: string = RouteService.injector.get(PLATFORM_ID) as string;\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\t// !!! Router dependancy manually activated\n\t\t\t// const router = RouteService.injector.get(Router);\n\t\t\tthis.router.events.subscribe((e) => {\n\t\t\t\tif (!(e instanceof NavigationEnd)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\twindow.scrollTo(0, 0);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetId(): number | string {\n\t\treturn this.routeService.getId() || (this.page ? this.page.id : 0);\n\t}\n\n\tgetSlug(): string {\n\t\treturn this.routeService.getSlug() || (this.page ? this.page.slug : '');\n\t}\n\n}\n","import { Component, Injector, ViewEncapsulation } from '@angular/core';\nimport { PageComponent } from './page.component';\n\n@Component({\n\tselector: 'page-not-found-component',\n\ttemplateUrl: './page-not-found.component.html',\n\tstyleUrls: ['./page-not-found.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\n\nexport class PageNotFoundComponent extends PageComponent {\n\n\tpublic url: string;\n\n\tconstructor(\n\t\tprotected injector: Injector\n\t) {\n\t\tsuper(injector);\n\t\tthis.url = this.router.url;\n\t}\n\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class HttpStatusCodeService {\n\n\tprivate statusCode: number;\n\tprivate redirectUrl: string;\n\n\tconstructor() {\n\t\tthis.statusCode = 200;\n\t\tthis.redirectUrl = null;\n\t}\n\n\tpublic setStatusCode(statusCode: number, redirectUrl: string = null) {\n\t\tthis.statusCode = statusCode;\n\t\tthis.redirectUrl = redirectUrl;\n\t}\n\n\tpublic getStatusCode(): number {\n\t\treturn (this.statusCode === 309 ? 301 : this.statusCode);\n\t}\n\n\tpublic getRedirectUrl(): string {\n\t\treturn this.redirectUrl;\n\t}\n\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { ApiService } from '../api/api.service';\nimport { Identity } from './identity';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class IdentityService<T extends Identity> extends ApiService<T> {\n\n\tconstructor(\n\t\tprotected injector: Injector\n\t) {\n\t\tsuper(injector);\n\t}\n\n\tget collection(): string {\n\t\treturn '/api/identity';\n\t}\n\n\tgetList(): Observable<T[]> {\n\t\treturn this.get();\n\t}\n\n\tgetDetailByIdNo404<Data>(id: number | string): Observable<T> {\n\t\treturn this.get({ id }).pipe(\n\t\t\tmap((identities: T[]) => identities[0]),\n\t\t);\n\t}\n\n\tgetDetailById(id: number | string): Observable<T> {\n\t\treturn this.get({ id });\n\t}\n\n\tadd(identity: T) {\n\t\treturn this.post(identity);\n\t}\n\n\tupdate(identity: T) {\n\t\treturn this.put(identity);\n\t}\n\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { Entity } from './entity';\nimport { IdentityService } from './identity.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class EntityService<T extends Entity> extends IdentityService<T> {\n\n\tget collection(): string {\n\t\treturn '/api/entity';\n\t}\n\n\tgetDetailByName(name: string): Observable<T[]> {\n\t\tif (!name.trim()) {\n\t\t\treturn of([]);\n\t\t}\n\t\treturn this.get({ name });\n\t}\n\n}\n","\nexport enum ImageType {\n\tDefault = 1,\n\tGallery = 2,\n\tShare = 3,\n}\n\nexport class Image {\n\tid: number | string;\n\turl: string;\n\ttitle?: string;\n\tdescription?: string;\n\tfileName?: string;\n\ttype?: ImageType;\n}\n","import { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable } from '@angular/core';\n\nexport class LinkDefinition {\n\thref?: string;\n\tid?: string;\n\trel?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root',\n})\nexport class LinkService {\n\n\tconstructor(\n\t\t@Inject(DOCUMENT) private doc: any,\n\t) { }\n\n\taddTag(definition: LinkDefinition) {\n\t\tconst element = this.doc.createElement(`link`);\n\t\tthis.updateElementDefinition(element, definition);\n\t\tthis.doc.head.appendChild(element);\n\t}\n\n\tgetTag(selector: string) {\n\t\tconst element = this.doc.querySelector(`link${selector}`);\n\t\treturn element;\n\t}\n\n\tupdateTag(selector: string, definition: LinkDefinition) {\n\t\tconst element = this.doc.querySelector(`link${selector}`);\n\t\tthis.updateElementDefinition(element, definition);\n\t}\n\n\tremoveTag(selector: string) {\n\t\tconst element = this.doc.querySelector(`link${selector}`);\n\t\telement.remove();\n\t}\n\n\tupdateElementDefinition(element: HTMLLinkElement, definition: LinkDefinition) {\n\t\tthis.updateElementAttribute(element, 'href', definition.href);\n\t\tthis.updateElementAttribute(element, 'id', definition.id);\n\t\tthis.updateElementAttribute(element, 'rel', definition.rel);\n\t}\n\n\tupdateElementAttribute(element: HTMLLinkElement, attribute: string, value: any) {\n\t\tif (value) {\n\t\t\telement.setAttribute(attribute, value);\n\t\t} else {\n\t\t\telement.removeAttribute(attribute);\n\t\t}\n\t}\n\n}\n","import { Document } from '../models/document';\nimport { Feature } from '../models/feature';\nimport { Image } from '../models/image';\nimport { Taxonomy } from '../models/taxonomy';\n\nexport class PageMeta {\n\tappId?: string;\n\tauthor?: string;\n\tcanonical?: string;\n\tdescription?: string;\n\tkeywords?: string;\n\tlocale?: string;\n\trobots?: string;\n\ttitle?: string;\n\ttype?: string;\n}\n\nexport class PageIndex implements Document {\n\tabstract?: string;\n\tid: number | string;\n\timages?: Image[];\n\tname?: string;\n\trelationType?: number | string;\n\tslug?: string;\n\ttitle?: string;\n\ttype?: number | string;\n\turl?: string;\n\n\tconstructor(options?: PageIndex) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n}\n\nexport class PageRelation implements Document {\n\tid: number | string;\n\tpage: Page;\n\ttype?: number | string;\n}\n\nexport class Page implements Document {\n\tabstract?: string;\n\tactive?: boolean;\n\tcomponent?: number | string;\n\tdescription?: string;\n\tfeatures?: Feature[];\n\tid: number | string;\n\timages?: Image[];\n\tmeta?: PageMeta = {};\n\tname?: string;\n\trelated?: any[];\n\tslug?: string;\n\ttaxonomies?: Taxonomy[];\n\ttitle?: string;\n\ttype?: number | string;\n\turl?: string;\n\n\tconstructor(options?: Page) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t\tif (options.related) {\n\t\t\t\tconst related: PageIndex[] = options.related.map((x: PageRelation) => {\n\t\t\t\t\tconst item = new PageIndex(x.page);\n\t\t\t\t\titem.relationType = x.type;\n\t\t\t\t\treturn item;\n\t\t\t\t});\n\t\t\t\tthis.related = related;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFeature?(id: number): Feature {\n\t\treturn this.features.find(x => x.id === id) || null;\n\t}\n\n\tgetFeatures?(type: number, n: number[]): Feature[] {\n\t\treturn this.features ? this.features.filter((x: Feature, i: number) => (\n\t\t\tn.indexOf(Number(x.id)) !== -1 && x.type === type\n\t\t)).sort((a: Feature, b: Feature) => a.type - b.type) : [];\n\t}\n\n\tgetFeaturesByTypes?(type: number[]): Feature[] {\n\t\treturn this.features ? this.features.filter((x: Feature) => (\n\t\t\ttype.indexOf(Number(x.type)) !== -1\n\t\t)) : [];\n\t}\n\n\tgetGroupedFeaturesByTypes?(type: number[]): any {\n\t\tconst groups = {};\n\t\ttype.forEach(type => {\n\t\t\tconst group = groups[type] || { features: [] };\n\t\t\tif (this.features) {\n\t\t\t\tthis.features.forEach((x: Feature) => {\n\t\t\t\t\tif (Number(x.type) === type) {\n\t\t\t\t\t\tgroup.features.push(x);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tgroups[type] = group;\n\t\t});\n\t\t/*\n\t\tif (this.features) {\n\t\t\tthis.features.forEach((x: Feature) => {\n\t\t\t\tif (type.indexOf(Number(x.type)) !== -1) {\n\t\t\t\t\tconst group = groups[x.type] || { features: [] };\n\t\t\t\t\tgroup.features.push(x);\n\t\t\t\t\tgroups[x.type] = group;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t*/\n\t\treturn groups;\n\t}\n\n\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { Meta, MetaDefinition, Title } from '@angular/platform-browser';\nimport { Observable, of } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { HttpStatusCodeService } from '../http/http-status-code.service';\nimport { EntityService } from '../models/entity.service';\nimport { Image, ImageType } from '../models/image';\nimport { LinkDefinition, LinkService } from './link.service';\nimport { Page } from './page';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class PageService extends EntityService<Page> {\n\n\tget collection(): string {\n\t\treturn '/api/page';\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector,\n\t\tprivate titleService: Title,\n\t\tprivate metaService: Meta,\n\t\tprivate linkService: LinkService,\n\t\tprivate statusCodeService: HttpStatusCodeService,\n\t) {\n\t\tsuper(injector);\n\t}\n\n\tgetStatePageBySlug(slug: string): Observable<Page> {\n\t\tslug = slug.split('?')[0];\n\t\tif (slug.indexOf('/') === 0) {\n\t\t\tslug = slug.substr(1);\n\t\t}\n\t\treturn this.stateGet(`?slug=/${slug}`).pipe(\n\t\t\tmap(x => {\n\t\t\t\tx = new Page(Array.isArray(x) ? x.find(x => x.slug === `/${slug}`) : x);\n\t\t\t\t// console.log('PageService.getStatePageBySlug', x);\n\t\t\t\treturn x;\n\t\t\t}),\n\t\t\tcatchError(error => {\n\t\t\t\t// console.log('getStatePageBySlug.error', error);\n\t\t\t\tthis.statusCodeService.setStatusCode(error.status, error.error ? error.error.redirectUrl : null);\n\t\t\t\treturn of(null);\n\t\t\t}),\n\t\t);\n\t}\n\n\tgetPageById(id: number | string): Observable<Page> {\n\t\treturn this.stateGet(`/${id}`).pipe(\n\t\t\t// tap(x => console.log('PageService.getPageById', id, x)),\n\t\t\tmap(x => new Page(x)),\n\t\t\tcatchError(error => {\n\t\t\t\tthis.statusCodeService.setStatusCode(error.status, error.error ? error.error.redirectUrl : null);\n\t\t\t\treturn of(null);\n\t\t\t})\n\t\t);\n\t}\n\n\tgetPageBySlug(slug: string): Observable<Page> {\n\t\tslug = slug.split(';')[0];\n\t\t// console.log('PageService.getPageBySlug', slug);\n\t\treturn this.get(`?slug=/${slug}`).pipe(\n\t\t\tmap(x => new Page(x)),\n\t\t\t// tap(x => this.logger.log(`found pages matching \"${slug}\"`))\n\t\t\t// tap(x => console.log('PageService.getPageBySlug', x, slug))\n\t\t\tcatchError(error => {\n\t\t\t\t// console.log('PageService.getPageBySlug.error', error);\n\t\t\t\tthis.statusCodeService.setStatusCode(error.status, error.error ? error.error.redirectUrl : null);\n\t\t\t\treturn of(null);\n\t\t\t})\n\t\t);\n\t}\n\n\taddOrUpdateMetaData(page: Page) {\n\t\t// console.log('PageService.addOrUpdateMetaData', page);\n\t\tif (!page) {\n\t\t\treturn;\n\t\t}\n\t\tconst fbAppId: string = this.config.plugins && this.config.plugins.facebook ? this.config.plugins.facebook.appId.toString() : '';\n\t\tthis.titleService.setTitle(page.title);\n\t\tthis.addOrUpdateMeta({ property: 'og:title', content: page.title });\n\t\tthis.addOrUpdateMeta({ property: 'og:image', content: this.getSocialImage(page).url });\n\t\tthis.addOrUpdateMeta({ property: 'og:image:width', content: '1200' });\n\t\tthis.addOrUpdateMeta({ property: 'og:image:height', content: '630' });\n\t\tthis.addOrUpdateMeta({ property: 'fb:app_id', content: fbAppId });\n\t\tthis.addOrUpdateMeta({ property: 'og:url', content: page.url || this.origin });\n\t\tconst meta = page.meta;\n\t\tif (meta) {\n\t\t\tthis.addOrUpdateMeta({ name: 'description', content: meta.description || 'Servizio di qualitÃÂ  senza costi aggiuntivi con i convenienti pacchetti viaggio Eurospin. Prenota comodamente online!' });\n\t\t\tthis.addOrUpdateMeta({ name: 'keywords', content: meta.keywords || 'viaggi,viaggi eurospin' });\n\t\t\tthis.addOrUpdateMeta({ name: 'robots', content: meta.robots || 'index,follow' });\n\t\t\tthis.addOrUpdateMeta({ property: 'og:locale', content: meta.locale || 'it_IT' });\n\t\t\tthis.addOrUpdateMeta({ property: 'og:type', content: meta.type || 'article' });\n\t\t\tthis.addOrUpdateMeta({ property: 'og:author', content: meta.author || 'Eurospin Viaggi' });\n\t\t\tthis.addOrUpdateLink({ rel: 'canonical', href: meta.canonical || (this.origin.indexOf(page.url) === 0 ? null : page.url) });\n\t\t}\n\t\t// console.log('PageOutletComponent.addOrUpdateMetaData', page.id, page.title, page.url);\n\t}\n\n\tprivate getSocialImage(page: Page): Image {\n\t\tconst image = page.images ? (\n\t\t\tpage.images.find(i => i.type === ImageType.Share) ||\n\t\t\tpage.images.find(i => i.type === ImageType.Default) ||\n\t\t\tpage.images.find(i => i.type === ImageType.Gallery)\n\t\t) : null;\n\t\treturn image || {\n\t\t\turl: 'https://s-static.ak.fbcdn.net/images/devsite/attachment_blank.png'\n\t\t} as Image;\n\t}\n\n\tprivate addOrUpdateMeta(definition: MetaDefinition) {\n\t\tconst selector = definition.name ? `name=\"${definition.name}\"` : `property=\"${definition.property}\"`;\n\t\tif (this.metaService.getTag(selector)) {\n\t\t\tif (definition.content) {\n\t\t\t\tthis.metaService.updateTag(definition, selector);\n\t\t\t} else {\n\t\t\t\tthis.metaService.removeTag(selector);\n\t\t\t}\n\t\t} else if (definition.content) {\n\t\t\tthis.metaService.addTag(definition);\n\t\t}\n\t}\n\n\tprivate addOrUpdateLink(definition: LinkDefinition) {\n\t\tconst selector = definition.id ? `#${definition.id}` : `[rel=\"${definition.rel}\"]`;\n\t\tif (this.linkService.getTag(selector)) {\n\t\t\tif (definition.href) {\n\t\t\t\tthis.linkService.updateTag(selector, definition);\n\t\t\t} else {\n\t\t\t\tthis.linkService.removeTag(selector);\n\t\t\t}\n\t\t} else if (definition.href) {\n\t\t\tthis.linkService.addTag(definition);\n\t\t}\n\t}\n\n}\n","import { Component, ComponentFactory, ComponentFactoryResolver, Inject, ViewContainerRef } from '@angular/core';\nimport { ActivatedRoute, ActivatedRouteSnapshot, Router } from '@angular/router';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { RouteService } from '../routes/route.service';\nimport { PageNotFoundComponent } from './page-not-found.component';\nimport { PageComponent } from './page.component';\nimport { PageService } from './page.service';\n\n@Component({\n\tselector: 'page-outlet',\n\ttemplate: '',\n})\n\nexport class PageOutletComponent extends DisposableComponent {\n\n\tprivate factory: ComponentFactory<PageComponent>;\n\n\tconstructor(\n\t\t@Inject(ViewContainerRef) private viewContainerRef: ViewContainerRef,\n\t\tprivate router: Router,\n\t\tprivate route: ActivatedRoute,\n\t\tprivate componentFactoryResolver: ComponentFactoryResolver,\n\t\tprivate routeService: RouteService,\n\t\tprivate pageService: PageService,\n\t) {\n\t\tsuper();\n\t\t// !!! keep -> Avoid PageOutlet Route Caching for different routes\n\t\tthis.router.routeReuseStrategy.shouldReuseRoute = () => {\n\t\t\treturn false;\n\t\t};\n\t\tthis.setSnapshot(this.route.snapshot);\n\t}\n\n\tsetSnapshot(snapshot: ActivatedRouteSnapshot): void {\n\t\tthis.routeService.params = this.routeService.toData(snapshot.params);\n\t\tthis.routeService.queryParams = this.routeService.toData(snapshot.queryParams);\n\t\tconst data = snapshot.data;\n\t\tconst params = this.routeService.params;\n\t\tconst queryParams = this.routeService.queryParams;\n\t\tlet component: any = PageNotFoundComponent;\n\t\tif (data.pageResolver) {\n\t\t\tcomponent = data.pageResolver.component;\n\t\t\tthis.routeService.page = data.pageResolver.page;\n\t\t\tconst factory: ComponentFactory<PageComponent> = this.componentFactoryResolver.resolveComponentFactory(component);\n\t\t\tthis.factory = factory;\n\t\t\tthis.viewContainerRef.clear();\n\t\t\tconst componentRef = this.viewContainerRef.createComponent(this.factory);\n\t\t\tconst instance = componentRef.instance;\n\t\t\tinstance.page = data.pageResolver.page;\n\t\t\tinstance.params = params;\n\t\t\tinstance.queryParams = queryParams;\n\t\t\tif (typeof instance['PageInit'] === 'function') {\n\t\t\t\tinstance['PageInit']();\n\t\t\t}\n\t\t\tif (data.pageResolver.page) {\n\t\t\t\tconst config = this.router.config.slice();\n\t\t\t\tconst slug = data.pageResolver.page.slug;\n\t\t\t\tif (slug) {\n\t\t\t\t\tconfig.push({\n\t\t\t\t\t\tpath: slug.indexOf('/') === 0 ? slug.substr(1) : slug, component: data.pageResolver.component,\n\t\t\t\t\t});\n\t\t\t\t\tthis.router.resetConfig(config);\n\t\t\t\t}\n\t\t\t\tthis.pageService.addOrUpdateMetaData(this.routeService.page);\n\t\t\t}\n\t\t}/* else {\n\t\t\t// console.log('PageOutletComponent.setSnapshot 404', data);\n\t\t}*/\n\t}\n\n}\n","import { Type } from '@angular/core';\nimport { ConfigService } from '../config/config.service';\nimport { Page } from './page';\nimport { PageNotFoundComponent } from './page-not-found.component';\nimport { PageComponent } from './page.component';\n\nexport class PageResolver {\n\n\tpublic component: Type<PageComponent> = PageComponent;\n\n\tconstructor(\n\t\tprivate configService: ConfigService,\n\t\tpublic page: Page,\n\t) {\n\t\tif (page && this.configService.options.pages) {\n\t\t\tthis.component = this.configService.options.pages[page.component] || this.configService.options.defaultPage;\n\t\t} else {\n\t\t\tthis.component = this.configService.options.notFoundPage || PageNotFoundComponent;\n\t\t}\n\t}\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, Resolve, RouterStateSnapshot } from '@angular/router';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { ConfigService } from '../config/config.service';\nimport { RouteService } from '../routes/route.service';\nimport { Page } from './page';\nimport { PageResolver } from './page-resolver';\nimport { PageService } from './page.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class PageResolverService implements Resolve<PageResolver> {\n\n\tpublic events$: BehaviorSubject<PageResolver> = new BehaviorSubject<PageResolver>(null);\n\n\tconstructor(\n\t\tprivate configService: ConfigService,\n\t\tprivate pageService: PageService,\n\t\tprivate routeService: RouteService,\n\t) { }\n\n\tpageToPageResolver(page: Page): PageResolver {\n\t\tconst pageResolver = new PageResolver(this.configService, page);\n\t\tthis.events$.next(pageResolver);\n\t\treturn pageResolver;\n\t}\n\n\tresolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<PageResolver> {\n\t\tif (route.params && route.params.id) {\n\t\t\treturn this.getPageById(route.params.id);\n\t\t} else {\n\t\t\tconst paths = route.url.filter(x => {\n\t\t\t\treturn x.path;\n\t\t\t}).map(x => {\n\t\t\t\treturn x.path;\n\t\t\t});\n\t\t\tconst slug = this.routeService.toSlug(paths).join('/');\n\t\t\treturn this.getPageBySlug(slug);\n\t\t}\n\t}\n\n\tgetPageById(id: number | string): Observable<PageResolver> {\n\t\t// console.log('PageResolverService.getPageById', id);\n\t\treturn this.pageService.getPageById(id).pipe(\n\t\t\tmap(page => this.pageToPageResolver(page))\n\t\t);\n\t}\n\n\tgetPageBySlug(slug: string): Observable<PageResolver> {\n\t\t// console.log('PageResolverService.getPageBySlug', slug);\n\t\treturn this.pageService.getStatePageBySlug(slug).pipe(\n\t\t\tmap(page => this.pageToPageResolver(page))\n\t\t);\n\t}\n\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, CanDeactivate, RouterStateSnapshot } from '@angular/router';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class PageGuard implements CanActivate, CanDeactivate<any> {\n\n\tprivate match(route: ActivatedRouteSnapshot): boolean {\n\t\tconst lastPath = route.url.length ? route.url[route.url.length - 1].path : '';\n\t\tconst pattern = /\\.([0-9a-z]+)(?:[\\?#]|$)/i;\n\t\tconst match = (lastPath).match(pattern);\n\t\tif (match !== null) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tcanActivate(\n\t\troute: ActivatedRouteSnapshot,\n\t\tstate: RouterStateSnapshot\n\t): Observable<boolean> | Promise<boolean> | boolean {\n\t\treturn this.match(route);\n\t}\n\n\tcanDeactivate(\n\t\tcomponent: any,\n\t\tcurrentRoute: ActivatedRouteSnapshot,\n\t\tcurrentState: RouterStateSnapshot,\n\t\tnextState?: RouterStateSnapshot\n\t): Observable<boolean> | Promise<boolean> | boolean {\n\t\treturn this.match(currentRoute);\n\t}\n\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, CanDeactivate, RouterStateSnapshot } from '@angular/router';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class StaticGuard implements CanActivate, CanDeactivate<any> {\n\n\tprivate match(route: ActivatedRouteSnapshot): boolean {\n\t\tconst lastPath = route.url[route.url.length - 1].path;\n\t\t// console.log('StaticGuard.CanActivate', e, lastPath);\n\t\tconst pattern = /\\.([0-9a-z]+)(?:[\\?#]|$)/i;\n\t\tconst match = (lastPath).match(pattern);\n\t\tif (match !== null) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tcanActivate(\n\t\troute: ActivatedRouteSnapshot,\n\t\tstate: RouterStateSnapshot\n\t): Observable<boolean> | Promise<boolean> | boolean {\n\t\treturn this.match(route);\n\t}\n\n\tcanDeactivate(\n\t\tcomponent: any,\n\t\tcurrentRoute: ActivatedRouteSnapshot,\n\t\tcurrentState: RouterStateSnapshot,\n\t\tnextState?: RouterStateSnapshot\n\t): Observable<boolean> | Promise<boolean> | boolean {\n\t\treturn this.match(currentRoute);\n\t}\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { PageNotFoundComponent } from './pages/page-not-found.component';\nimport { PageOutletComponent } from './pages/page-outlet.component';\nimport { PageResolverService } from './pages/page-resolver.service';\nimport { PageGuard } from './pages/page.guard';\nimport { StaticGuard } from './pages/static.guard';\n\nconst routes: Routes = [\n\t{ path: 'page/:id', component: PageOutletComponent, resolve: { pageResolver: PageResolverService } },\n\t{ path: '**', component: PageOutletComponent, resolve: { pageResolver: PageResolverService }, canActivate: [PageGuard] },\n\t{ path: '**', component: PageNotFoundComponent, canActivate: [StaticGuard] },\n];\n\n@NgModule({\n\timports: [\n\t\tRouterModule.forChild(routes),\n\t],\n\texports: [\n\t\tRouterModule,\n\t],\n})\n\nexport class CoreRouting { }\n","export class ControlBaseOptions<T> {\n\tvalue?: T;\n\tkey?: string;\n\tlabel?: string;\n\tplaceholder?: string;\n\t// order\n\torder?: number;\n\tschema?: string;\n\ttype?: string;\n\t// validators\n\tmin?: number;\n\tmax?: number;\n\trequired?: boolean;\n\trequiredTrue?: boolean;\n\temail?: boolean;\n\tminLength?: number;\n\tmaxLength?: number;\n\tpattern?: string | RegExp;\n\tmatch?: string;\n\t// options\n\treverse?: boolean;\n\toptions?: { key: string, value: string }[];\n\t// state\n\tdisabled?: boolean;\n\t// formatters\n\tstep?: number;\n\tformat?: string;\n}\n\nexport class ControlBase<T> {\n\t// export class ControlBase<T> implements ControlValueAccessor {\n\n\tstatic uid: number = 0;\n\n\tprivate _originalValue: T;\n\tvalue: T;\n\tkey: string;\n\t//\n\tlabel: string;\n\tplaceholder: string;\n\t// order\n\torder: number;\n\tschema: string;\n\ttype: string;\n\t// validators\n\tmin: number;\n\tmax: number;\n\trequired: boolean;\n\trequiredTrue: boolean;\n\temail: boolean;\n\tminLength: number;\n\tmaxLength: number;\n\tpattern: string | RegExp;\n\tmatch: string;\n\t// options\n\treverse: boolean;\n\toptions: { key: string, value: string }[];\n\t// state\n\tdisabled: boolean;\n\t// formatters\n\tstep: number;\n\tformat: string;\n\n\tconstructor(options: ControlBaseOptions<T> = {}) {\n\t\tthis._originalValue = options.value;\n\t\tthis.value = options.value;\n\t\tthis.key = options.key;\n\t\t//\n\t\tconst name = `${options.key || 'Control'} ${++ControlBase.uid}`;\n\t\tthis.label = options.label || name;\n\t\tthis.placeholder = options.placeholder || name;\n\t\t// order\n\t\tthis.order = options.order === undefined ? 1 : options.order;\n\t\tthis.schema = options.schema || 'text';\n\t\tthis.type = options.type || this.schema;\n\t\t// validators\n\t\tthis.min = options.min || null;\n\t\tthis.max = options.max || null;\n\t\tthis.required = !!options.required;\n\t\tthis.requiredTrue = !!options.requiredTrue;\n\t\tthis.email = !!options.email;\n\t\tthis.minLength = options.minLength || null;\n\t\tthis.maxLength = options.maxLength || null;\n\t\tthis.pattern = options.pattern || null;\n\t\tthis.match = options.match || null;\n\t\t// options\n\t\tthis.reverse = !!options.reverse;\n\t\tthis.options = options.options || [];\n\t\t// state\n\t\tthis.disabled = !!options.disabled;\n\t\t// formatters\n\t\tthis.step = options.step || null;\n\t\tthis.format = options.format || null;\n\t}\n\n\t/*\n\t//\n\tcontrol?: FormControl;\n\tinnervalue: any;\n\tblurred: boolean = false;\n\n\tfocus(): void {\n\t\t// console.log('ControlBase.focus', this.control.value);\n\t\tthis.blurred = false;\n\t\tif (this.innervalue) {\n\t\t\tthis.control.patchValue(this.innervalue, { emitEvent: false });\n\t\t}\n\t}\n\n\tblur(): void {\n\t\t// console.log('ControlBase.blur', this.control.value);\n\t\tthis.blurred = true;\n\t\tif (this.innervalue) {\n\t\t\tthis.control.patchValue(this.innervalue + ' H', { emitEvent: false });\n\t\t}\n\t}\n\n\tsetControl(control: FormControl): void {\n\t\tthis.control = control;\n\t\tthis.innervalue = control.value;\n\t\tcontrol.valueChanges.subscribe(value => {\n\t\t\t// console.log('ControlBase.control.valueChanges', value);\n\t\t\tif (this.blurred) {\n\t\t\t\tcontrol.patchValue(value + ' H', { emitEvent: false });\n\t\t\t} else {\n\t\t\t\tthis.innervalue = value;\n\t\t\t}\n\t\t});\n\t\t// this.blur();\n\t}\n\n\tformatValue(): string {\n\t\t// console.log('ControlBase.formatValue', this, this.control);\n\t\treturn 'aaa';\n\t}\n\n\tparseValue(e: Event) {\n\t\t// console.log('ControlBase.parseValue', e);\n\t}\n\n\tprivate onChange = (value: any) => { };\n\n\tprivate onTouched = () => { };\n\n\twriteValue(value: any): void {\n\t\t// console.log('ControlBase.writeValue', value);\n\t\t// this.formattedValue = value;\n\t\tthis.onChange(this.value);\n\t}\n\n\tregisterOnChange(fn: (value: any) => void): void {\n\t\t// console.log('ControlBase.registerOnChange', fn);\n\t\tthis.onChange = fn;\n\t\t// this.onChange('my new value');\n\t}\n\n\tregisterOnTouched(fn: () => void): void {\n\t\t// console.log('ControlBase.registerOnTouched', fn);\n\t\tthis.onTouched = fn;\n\t}\n\n\tsetDisabledState?(isDisabled: boolean): void {\n\t\t// console.log('ControlBase.setDisabledState', isDisabled);\n\t\tthis.disabled = isDisabled;\n\t}\n\t*/\n\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlCheckbox extends ControlBase<boolean> {\n\n\tschema = 'checkbox';\n\n\tconstructor(options: ControlBaseOptions<boolean> = {}) {\n\t\tsuper(options);\n\t\tthis.type = options.type || this.type;\n\t}\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlEmail extends ControlBase<string> {\n\n\tschema = 'email';\n\n\tconstructor(options: ControlBaseOptions<string> = {}) {\n\t\tsuper(options);\n\t\tthis.type = options.type || this.type;\n\t\tthis.email = true;\n\t\tthis.pattern = options.pattern || '[a-zA-Z0-9.-_]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{2,}';\n\t}\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlMarkdown extends ControlBase<string> {\n\n\tschema = 'markdown';\n\n\tconstructor(options: ControlBaseOptions<string> = {}) {\n\t\tsuper(options);\n\t\tthis.type = options.type || this.type;\n\t}\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlNumber extends ControlBase<string> {\n\n\tschema = 'number';\n\n\tconstructor(options: ControlBaseOptions<string> = {}) {\n\t\tsuper(options);\n\t\tthis.type = options.type || this.type;\n\t}\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlPassword extends ControlBase<string> {\n\n\tschema = 'password';\n\n\tconstructor(options: ControlBaseOptions<string> = {}) {\n\t\tsuper(options);\n\t\tthis.type = options.type || this.type;\n\t}\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlRadio extends ControlBase<boolean> {\n\n\tschema = 'radio';\n\n\tconstructor(options: ControlBaseOptions<boolean> = {}) {\n\t\tsuper(options);\n\t\tthis.type = options.type || this.type;\n\t}\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlSelect extends ControlBase<string> {\n\n\tschema = 'select';\n\toptions: { key: string, value: string }[] = [];\n\n\tconstructor(options: ControlBaseOptions<string> = {}) {\n\t\tsuper(options);\n\t\tthis.options = options.options || [];\n\t}\n}\n","import { ControlBase, ControlBaseOptions } from './control-base';\n\nexport class ControlText extends ControlBase<string> {\n\n\tschema = 'text';\n\n\tconstructor(options: ControlBaseOptions<string> = {}) {\n\t\tsuper(options);\n\t\tthis.type = options.type || this.type;\n\t}\n}\n","import { Injectable } from '@angular/core';\nimport { FormControl, FormGroup, ValidatorFn, Validators } from '@angular/forms';\nimport { ControlBase } from './control-base';\nimport { matchValidator } from './match.validator';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ControlService {\n\n\tgetValidators(control: ControlBase<any>, group: FormGroup): ValidatorFn[] {\n\t\tconst validators: ValidatorFn[] = [];\n\t\tif (control.min) {\n\t\t\tvalidators.push(Validators.min(control.min));\n\t\t}\n\t\tif (control.max) {\n\t\t\tvalidators.push(Validators.max(control.max));\n\t\t}\n\t\tif (control.required) {\n\t\t\tvalidators.push(Validators.required);\n\t\t}\n\t\tif (control.requiredTrue) {\n\t\t\tvalidators.push(Validators.requiredTrue);\n\t\t}\n\t\tif (control.email) {\n\t\t\tvalidators.push(Validators.email);\n\t\t}\n\t\tif (control.minLength) {\n\t\t\tvalidators.push(Validators.minLength(control.minLength));\n\t\t}\n\t\tif (control.maxLength) {\n\t\t\tvalidators.push(Validators.maxLength(control.maxLength));\n\t\t}\n\t\tif (control.pattern) {\n\t\t\tvalidators.push(Validators.pattern(control.pattern));\n\t\t}\n\t\tif (control.match) {\n\t\t\tvalidators.push(matchValidator(control.match, control.reverse, group));\n\t\t}\n\t\t// console.log(control.key, validators);\n\t\treturn validators;\n\t}\n\n\ttoFormGroup(controls: ControlBase<any>[]): FormGroup {\n\t\tconst options: any = {};\n\t\tcontrols.forEach(x => {\n\t\t\t// group[x.key] = new FormControl(x.value, this.getValidators(x, group));\n\t\t\tconst formControl: FormControl = new FormControl(x.value);\n\t\t\tif (x.disabled) {\n\t\t\t\tformControl.disable();\n\t\t\t}\n\t\t\toptions[x.key] = formControl;\n\t\t\t// x.setControl(formControl); // !!!\n\t\t});\n\t\tconst group: FormGroup = new FormGroup(options);\n\t\t// console.log(group);\n\t\tcontrols.forEach(x => {\n\t\t\tconst validators = this.getValidators(x, group);\n\t\t\t// console.log(validators);\n\t\t\tgroup.controls[x.key].setValidators(validators);\n\t\t});\n\t\treturn group;\n\t}\n\n}\n","import { FormControl, FormGroup, ValidatorFn } from '@angular/forms';\n\nexport function __matchValidator(key: string, otherKey: string, group: FormGroup): ValidatorFn {\n\treturn (control: FormControl) => {\n\n\t\t// const control = group.controls[key];\n\t\tconst otherControl = group.controls[otherKey];\n\n\t\t// console.log(control.touched, otherControl.touched);\n\n\t\tif (control.touched && otherControl.touched) {\n\t\t\tconst match = control.value === otherControl.value;\n\t\t\tif (!match && control.valid && otherControl.valid) {\n\t\t\t\tcontrol.setErrors({\n\t\t\t\t\tmatch: otherKey\n\t\t\t\t});\n\t\t\t\treturn {\n\t\t\t\t\tmatch: otherKey + ' != ' + key\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (match && control.hasError('match')) {\n\t\t\t\tcontrol.setErrors(null);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n}\n\nexport function matchValidator(otherKey: string, reverse: boolean = false, group: FormGroup): ValidatorFn {\n\treturn (control: FormControl) => {\n\t\tconst otherControl = group.controls[otherKey];\n\n\t\tconst value = control.value;\n\n\t\t// value not equal\n\t\tif (otherControl && value !== otherControl.value && !reverse) {\n\t\t\treturn {\n\t\t\t\tmatch: true,\n\t\t\t};\n\t\t}\n\n\t\t// value equal and reverse\n\t\tif (otherControl && value === otherControl.value && reverse) {\n\t\t\tif (otherControl.errors) {\n\t\t\t\tdelete otherControl.errors['match'];\n\t\t\t\tif (!Object.keys(otherControl.errors).length) {\n\t\t\t\t\totherControl.setErrors(null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// value not equal and reverse\n\t\tif (otherControl && value !== otherControl.value && reverse) {\n\t\t\totherControl.setErrors({\n\t\t\t\tmatch: true,\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t};\n}\n\n/*\nvalidate(control: AbstractControl): { [key: string]: any } {\n\t\t// self value\n\t\tconst value = control.value;\n\n\t\t// control value\n\t\tconst input = control.root.get(this.match);\n\n\t\t// value not equal\n\t\tif (input && value !== input.value && !this.isReverse) {\n\t\t\treturn {\n\t\t\t\tmatch: true,\n\t\t\t};\n\t\t}\n\n\t\t// value equal and reverse\n\t\tif (input && value === input.value && this.isReverse) {\n\t\t\tdelete input.errors['match'];\n\t\t\tif (!Object.keys(input.errors).length) {\n\t\t\t\tinput.setErrors(null);\n\t\t\t}\n\t\t}\n\t\t// value not equal and reverse\n\t\tif (input && value !== input.value && this.isReverse) {\n\t\t\tinput.setErrors({\n\t\t\t\tmatch: true,\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n*/\n/*\nstatic isValidString(control: FormControl) {\n\tif (!control.value || typeof control.value !== 'string') {\n\t\treturn {isNotValidString: true};\n\t}\n\treturn null;\n}\n\nstatic isValidName(control: FormControl) {\n\tif (control.valid && control.value !== 'John Doe') {\n\t\treturn {isNotValidName: true};\n\t}\n\treturn null;\n}\n*/\n","import { Injectable } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { ControlBase, ControlBaseOptions } from './controls/control-base';\nimport { ControlCheckbox } from './controls/control-checkbox';\nimport { ControlEmail } from './controls/control-email';\nimport { ControlMarkdown } from './controls/control-markdown';\nimport { ControlNumber } from './controls/control-number';\nimport { ControlPassword } from './controls/control-password';\nimport { ControlRadio } from './controls/control-radio';\nimport { ControlSelect } from './controls/control-select';\nimport { ControlText } from './controls/control-text';\nimport { ControlService } from './controls/control.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class FormService {\n\n\tconstructor(\n\t\tprivate controlService: ControlService\n\t) { }\n\n\tgetControlsFromOptions(options: ControlBaseOptions<any>[]): ControlBase<any>[] {\n\t\tconst controls: ControlBase<any>[] = options.map(o => {\n\t\t\tswitch (o.schema) {\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\treturn new ControlCheckbox(o);\n\t\t\t\tcase 'email':\n\t\t\t\t\treturn new ControlEmail(o);\n\t\t\t\tcase 'number':\n\t\t\t\t\treturn new ControlNumber(o);\n\t\t\t\tcase 'password':\n\t\t\t\t\treturn new ControlPassword(o);\n\t\t\t\tcase 'radio':\n\t\t\t\t\treturn new ControlRadio(o);\n\t\t\t\tcase 'select':\n\t\t\t\t\treturn new ControlSelect(o);\n\t\t\t\tcase 'markdown':\n\t\t\t\t\treturn new ControlMarkdown(o);\n\t\t\t\tcase 'text':\n\t\t\t\t\treturn new ControlText(o);\n\t\t\t\tdefault:\n\t\t\t\t\treturn new ControlText(o);\n\t\t\t}\n\t\t});\n\t\tcontrols.sort((a, b) => a.order - b.order);\n\t\treturn controls;\n\t}\n\n\tgetGroupFromOptions(options: ControlBaseOptions<any>[]): FormGroup {\n\t\tconst controls: ControlBase<any>[] = this.getControlsFromOptions(options);\n\t\tconst group = this.controlService.toFormGroup(controls);\n\t\treturn group;\n\t}\n\n\tgetGroupFromControls(controls: ControlBase<any>[]): FormGroup {\n\t\tconst group = this.controlService.toFormGroup(controls);\n\t\treturn group;\n\t}\n\n}\n","import { animate, state, style, transition, trigger } from '@angular/animations';\nimport { isPlatformBrowser } from '@angular/common';\nimport { AfterViewInit, Component, HostListener, Inject, PLATFORM_ID, ViewEncapsulation } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { MarkdownService } from 'ngx-markdown';\nimport { takeUntil } from 'rxjs/operators';\nimport { ConfigService } from '../config/config.service';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { ControlBase, ControlBaseOptions } from '../forms/controls/control-base';\nimport { FormService } from '../forms/form.service';\nimport { Page } from '../pages/page';\nimport { PageResolver } from '../pages/page-resolver';\nimport { PageResolverService } from '../pages/page-resolver.service';\n\n@Component({\n\tselector: 'ws-editor',\n\ttemplateUrl: './editor.component.html',\n\tstyleUrls: ['./editor.component.scss'],\n\tanimations: [\n\t\ttrigger('openClose', [\n\t\t\tstate('open', style({\n\t\t\t\topacity: 1,\n\t\t\t\ttransform: 'translateX(0)',\n\t\t\t})),\n\t\t\tstate('closed', style({\n\t\t\t\topacity: 0.5,\n\t\t\t\ttransform: 'translateX(100%)',\n\t\t\t})),\n\t\t\ttransition('open => closed', [\n\t\t\t\tanimate('250ms')\n\t\t\t]),\n\t\t\ttransition('closed => open', [\n\t\t\t\tanimate('150ms')\n\t\t\t]),\n\t\t]),\n\t],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\nexport class EditorComponent extends DisposableComponent implements AfterViewInit {\n\n\tprivate _pageCopy: Page;\n\tprivate _page: Page;\n\n\tcontrols: ControlBase<any>[];\n\tgroup: FormGroup;\n\n\tediting: boolean = false;\n\tbusy: boolean = false;\n\tsubmitted: boolean = false;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate markdownService: MarkdownService,\n\t\tprivate formService: FormService,\n\t\tprivate pageResolverService: PageResolverService,\n\t) {\n\t\tsuper();\n\t}\n\n\tget page(): Page {\n\t\treturn this._page;\n\t}\n\n\tset page(page: Page) {\n\t\tthis._pageCopy = Object.assign({}, page);\n\t\tthis._page = page;\n\t\tif (this._page) {\n\t\t\tthis.controls = this.formService.getControlsFromOptions(this.getControlsByPage(page));\n\t\t\tthis.group = this.formService.getGroupFromControls(this.controls);\n\t\t\tthis.group.valueChanges.subscribe(x => {\n\t\t\t\tthis.onAssign(x); // Object.assign(this._page, x);\n\t\t\t});\n\t\t} else {\n\t\t\tthis.controls = [];\n\t\t\tthis.group = null;\n\t\t}\n\t}\n\n\tget componentName(): string {\n\t\tif (this._page) {\n\t\t\tconst component = this.configService.options.pages[this._page.component];\n\t\t\tif (component) {\n\t\t\t\treturn component.name;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetControlsByPage(page: Page): ControlBaseOptions<any>[] {\n\t\treturn page ? Object.keys(page).filter(key => typeof page[key] !== 'object').map((key: string, i: number) => {\n\t\t\treturn {\n\t\t\t\tkey: key,\n\t\t\t\tvalue: page[key],\n\t\t\t\tschema: key === 'description' ? 'markdown' : 'text',\n\t\t\t\tlabel: key,\n\t\t\t\tplaceholder: key,\n\t\t\t\trequired: false,\n\t\t\t\torder: i + 1\n\t\t\t};\n\t\t}) : [];\n\t}\n\n\tngAfterViewInit() {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tthis.pageResolverService.events$.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe)\n\t\t\t).subscribe((resolver: PageResolver) => {\n\t\t\t\t// console.log('EditorComponent.resolver', resolver);\n\t\t\t\tthis.page = resolver ? resolver.page : null;\n\t\t\t});\n\t\t}\n\t}\n\n\t@HostListener('document:keydown', ['$event'])\n\tonKeydown(e: KeyboardEvent) {\n\t\tif (e.key === 'e' && e.ctrlKey) {\n\t\t\t// this.editing = this.configService.options.editor && !this.editing;\n\t\t\tthis.editing = !this.editing;\n\t\t\t// console.log('AppComponent.document:keydown', e.key, e.ctrlKey, e.altKey, e.code);\n\t\t}\n\t}\n\n\tonReset() {\n\t\t// console.log('EditorComponent.onReset');\n\t\tObject.keys(this.group.controls).forEach(key => {\n\t\t\tthis.group.get(key).setValue(this._pageCopy[key]);\n\t\t});\n\t\t/*\n\t\tconst keys = this.controls.map(x => x.key);\n\t\tkeys.forEach(k => {\n\t\t\t// console.log(k, this._page[k], this._pageCopy[k]);\n\t\t\tthis._page[k] = this._pageCopy[k];\n\t\t});\n\t\t*/\n\t}\n\n\tonSubmit(model) {\n\t\t// console.log('EditorComponent.onSubmit', model);\n\t\tthis.onAssign(model);\n\t\t// Object.assign(this._page, model);\n\t}\n\n\tonAssign(model) {\n\t\tObject.keys(this.group.controls).forEach(key => {\n\t\t\tswitch (key) {\n\t\t\t\tcase 'description':\n\t\t\t\t\tthis._page[key] = this.markdownService.compile(model[key]);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis._page[key] = model[key];\n\t\t\t}\n\t\t});\n\t}\n\n}\n","import { Component, forwardRef, Input, Renderer2 } from '@angular/core';\nimport { AbstractControl, ControlValueAccessor, FormGroup, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { ControlBase } from './control-base';\n\n@Component({\n\tselector: 'ws-control',\n\ttemplateUrl: './control.component.html',\n\tstyleUrls: ['./control.component.scss'],\n\tproviders: [{\n\t\tprovide: NG_VALUE_ACCESSOR,\n\t\tuseExisting: forwardRef(() => ControlComponent),\n\t\tmulti: true,\n\t}],\n})\nexport class ControlComponent implements ControlValueAccessor {\n\t@Input() control: ControlBase<any>;\n\t@Input() form: FormGroup;\n\n\tprivate element: any;\n\tprivate blurred: boolean;\n\tprivate innervalue: any;\n\n\treveal: { checked: boolean } = { checked: false };\n\n\tconstructor(\n\t\tprivate renderer: Renderer2\n\t) { }\n\n\tget controlRef(): AbstractControl {\n\t\t// console.log('controlRef', this.control.key, this.form.controls);\n\t\treturn this.form.controls[this.control.key];\n\t}\n\n\tget isValid() { return this.controlRef.valid; }\n\n\t// ControlValueAccessor\n\n\tgetFormattedValue(): any {\n\t\t// console.log('ControlComponent.getFormattedValue', this.controlRef.value);\n\t\treturn this.controlRef.value;\n\t}\n\n\tonInput($event): void {\n\t\tthis.element = $event.target;\n\t\tthis.onChange(this.element.value);\n\t}\n\n\tonFocus($event): void {\n\t\tthis.blurred = false;\n\t\tthis.element = $event.target;\n\t\t// this.element.value = this.controlRef.value;\n\t\tthis.renderer.setProperty(this.element, 'value', this.controlRef.value);\n\t\t// console.log('ControlComponent.onFocus', this.controlRef);\n\t}\n\n\tonBlur($event): void {\n\t\tthis.blurred = true;\n\t\tthis.element = $event.target;\n\t\t// this.element.value = this.controlRef.value;\n\t\tthis.renderer.setProperty(this.element, 'value', this.controlRef.value);\n\t\t// console.log('ControlComponent.onBlur', this.controlRef);\n\t\t/*\n\t\tif (this.innervalue) {\n\t\t\tthis.control.patchValue(this.innervalue + ' H', { emitEvent: false });\n\t\t}\n\t\t*/\n\t}\n\n\tprivate onChange = (value: any) => { };\n\n\tprivate onTouched = () => { };\n\n\tprivate formatValue(value: any): void {\n\t\t// console.log('ControlComponent.formatValue', value);\n\t\tthis.renderer.setProperty(this.element, 'value', value);\n\t\t// console.log('ControlEditableComponent.writeValue', value);\n\t}\n\n\tprivate parseValue(value: any) {\n\t\t// console.log('ControlComponent.parseValue', value);\n\t\tconst parsed = this.innervalue;\n\t\tthis.onChange(parsed);\n\t}\n\n\twriteValue(value: any): void {\n\t\tthis.formatValue(value);\n\t}\n\n\tregisterOnChange(fn: any): void {\n\t\tthis.onChange = fn;\n\t\t// console.log('ControlEditableComponent.registerOnChange');\n\t}\n\n\tregisterOnTouched(fn: any): void {\n\t\tthis.onTouched = fn;\n\t\t// console.log('ControlEditableComponent.registerOnTouched');\n\t}\n\n\tsetDisabledState(isDisabled: boolean): void {\n\t\t// const node = this.textarea.nativeElement;\n\t\t/*\n\t\tif (isDisabled) {\n\t\t\tthis.renderer.addClass(this.element, 'disabled');\n\t\t} else {\n\t\t\tthis.renderer.removeClass(this.element, 'disabled');\n\t\t}\n\t\t// console.log('ControlEditableComponent.setDisabledState', isDisabled);\n\t\t*/\n\t}\n\n}\n","import { Directive, forwardRef, Input } from '@angular/core';\nimport { AbstractControl, AsyncValidator, NG_ASYNC_VALIDATORS, ValidationErrors } from '@angular/forms';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { catchError, debounceTime, switchMap, take } from 'rxjs/operators';\n\nconst DEBOUNCE_TIME: number = 250;\n\n@Directive({\n\tselector: '[exists][formControlName],[exists][formControl],[exists][ngModel]',\n\tproviders: [\n\t\t{ provide: NG_ASYNC_VALIDATORS, useExisting: forwardRef(() => ExistsValidator), multi: true },\n\t]\n})\nexport class ExistsValidator implements AsyncValidator {\n\n\tprivate values = new BehaviorSubject<string>(null);\n\tset value(value: string) {\n\t\tif (value && value.trim() !== '') {\n\t\t\tthis.values.next(value);\n\t\t}\n\t}\n\tprivate debounced$: Observable<ValidationErrors | null> = this.values.pipe(\n\t\tdebounceTime(DEBOUNCE_TIME),\n\t\tswitchMap((value: string) => {\n\t\t\t// console.log('ExistsValidator.debounced$', value);\n\t\t\treturn this.exists$(value);\n\t\t}),\n\t\tcatchError((response) => {\n\t\t\tconsole.log('ExistsValidator.debounced$.catchError', response);\n\t\t\treturn of(null);\n\t\t}),\n\t\ttake(1),\n\t);\n\n\t@Input() exists: Function;\n\n\texists$(value: string): Observable<ValidationErrors | null> {\n\t\tif (typeof this.exists === 'function') {\n\t\t\t// console.log('ExistsValidator.exists$', value);\n\t\t\treturn this.exists(value).pipe(\n\t\t\t\tswitchMap(exists => {\n\t\t\t\t\tif (exists) {\n\t\t\t\t\t\treturn of({\n\t\t\t\t\t\t\texists: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn of(null);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n\tvalidate(control: AbstractControl): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n\t\tthis.value = control.value;\n\t\treturn this.debounced$;\n\t}\n\n}\n","import { Attribute, Directive, forwardRef } from '@angular/core';\nimport { AbstractControl, NG_VALIDATORS, Validator } from '@angular/forms';\n\n@Directive({\n\tselector: '[match][formControlName],[match][formControl],[match][ngModel]',\n\tproviders: [\n\t\t{ provide: NG_VALIDATORS, useExisting: forwardRef(() => MatchValidator), multi: true }\n\t]\n})\nexport class MatchValidator implements Validator {\n\n\tconstructor(\n\t\t@Attribute('match') public match: string,\n\t\t@Attribute('reverse') public reverse: string\n\t) { }\n\n\tprivate get isReverse() {\n\t\tif (!this.reverse) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.reverse === 'true' ? true : false;\n\t}\n\n\tvalidate(control: AbstractControl): { [key: string]: any } {\n\t\t// self value\n\t\tconst value = control.value;\n\n\t\t// control value\n\t\tconst input = control.root.get(this.match);\n\n\t\t// value not equal\n\t\tif (input && value !== input.value && !this.isReverse) {\n\t\t\treturn {\n\t\t\t\tmatch: true,\n\t\t\t};\n\t\t}\n\n\t\t// value equal and reverse\n\t\tif (input && value === input.value && this.isReverse) {\n\t\t\tdelete input.errors['match'];\n\t\t\tif (!Object.keys(input.errors).length) {\n\t\t\t\tinput.setErrors(null);\n\t\t\t}\n\t\t}\n\t\t// value not equal and reverse\n\t\tif (input && value !== input.value && this.isReverse) {\n\t\t\tinput.setErrors({\n\t\t\t\tmatch: true,\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n\n}\n","import { Directive, EventEmitter, HostListener, Output } from '@angular/core';\n\n@Directive({\n\tselector: '[ngModel][uppercase]'\n})\nexport class UppercaseDirective {\n\t@Output() ngModelChange: EventEmitter<any> = new EventEmitter();\n\tvalue: any;\n\n\t@HostListener('input', ['$event']) onInputChange($event) {\n\t\tthis.value = $event.target.value.toUpperCase();\n\t\tthis.ngModelChange.emit(this.value);\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n\tname: 'highlight',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class HighlightPipe implements PipeTransform {\n\n\ttransform(text: string, query: string): string {\n\t\tif (!query) {\n\t\t\treturn text;\n\t\t}\n\t\ttext = this.encodeHTML(text);\n\t\tquery = this.encodeHTML(query);\n\t\tconst regExp = new RegExp('&[^;]+;|' + this.escapeRegexChars(query), 'gi');\n\t\treturn text.replace(regExp, function (match) {\n\t\t\treturn match.toLowerCase() === query.toLowerCase() ? '<strong>' + match + '</strong>' : match;\n\t\t});\n\t}\n\n\tescapeRegexChars(text: string) {\n\t\treturn text.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n\t}\n\n\tsafeToString(text: string) {\n\t\treturn text === undefined || text === null ? '' : text.toString().trim();\n\t}\n\n\tencodeHTML(text: string) {\n\t\treturn this.safeToString(text)\n\t\t\t.replace(/&/g, '&amp;')\n\t\t\t.replace(/</g, '&lt;')\n\t\t\t.replace(/>/g, '&gt;');\n\t}\n\n}\n","\nimport { HttpErrorResponse, HttpEvent, HttpHandler, HttpInterceptor, HttpRequest } from '@angular/common/http';\nimport { Injectable, Injector } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport { Logger } from '../logger/logger';\nimport { RouteService } from '../routes/route.service';\nimport { HttpStatusCodeService } from './http-status-code.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class HttpResponseInterceptor implements HttpInterceptor {\n\n\tprivate _logger: Logger;\n\tget logger() {\n\t\tif (!this._logger) {\n\t\t\tthis._logger = this.injector.get(Logger);\n\t\t}\n\t\treturn this._logger;\n\t}\n\n\tprivate _router: Router;\n\tget router() {\n\t\tif (!this._router) {\n\t\t\tthis._router = this.injector.get(Router);\n\t\t}\n\t\treturn this._router;\n\t}\n\n\tprivate _routeService: RouteService;\n\tget routeService() {\n\t\tif (!this._routeService) {\n\t\t\tthis._routeService = this.injector.get(RouteService);\n\t\t}\n\t\treturn this.routeService;\n\t}\n\n\tconstructor(\n\t\tprivate injector: Injector,\n\t\tprivate statusCodeService: HttpStatusCodeService,\n\t) { }\n\n\tintercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\t\t// injecting request\n\t\t// parsing response\n\t\treturn next.handle(request).pipe(\n\t\t\ttap((event: HttpEvent<any>) => {\n\t\t\t\t// console.log('HttpResponseInterceptor', event);\n\t\t\t\tthis.logger.httpError = null;\n\t\t\t\t// this.logger.log(event);\n\t\t\t\t/*\n\t\t\t\tif (event instanceof HttpResponse) {\n\t\t\t\t\t// console.log('event instanceof HttpResponse');\n\t\t\t\t\t// do stuff with response if you want\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}),\n\t\t\tcatchError((error: any) => {\n\t\t\t\t// console.warn('HttpResponseInterceptor', error);\n\t\t\t\tif (error instanceof HttpErrorResponse) {\n\t\t\t\t\t// this.statusCodeService.setStatusCode(error.status);\n\t\t\t\t\tswitch (error.status) {\n\t\t\t\t\t\tcase 401:\n\t\t\t\t\t\t\t// unauthorized\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 404:\n\t\t\t\t\t\t\t// not found\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 409:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 410:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthis.logger.http(error);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn throwError(error);\n\t\t\t})\n\t\t);\n\t}\n\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Component, ElementRef, Inject, Input, OnChanges, PLATFORM_ID, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { isArray, isObject } from 'util';\n// import JSONFormatter from 'json-formatter-js';\n\n@Component({\n\tselector: 'json-formatter',\n\ttemplate: `<div #jsonFormatter></div>`,\n\tstyleUrls: ['./json-formatter.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\nexport class JsonFormatterComponent implements OnChanges {\n\t@ViewChild(`jsonFormatter`) input: ElementRef;\n\n\t@Input() json: Array<any> | Object | any;\n\n\telementRef: ElementRef;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t) { }\n\n\tngOnChanges() {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tif (!isObject(this.json) && !isArray(this.json)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// console.log('JsonFormatterComponent', this.json);\n\t\t\tif (this.elementRef) {\n\t\t\t\tthis.input.nativeElement.removeChild(this.elementRef.nativeElement);\n\t\t\t}\n\t\t\tconst JSONFormatter = require('json-formatter-js').default;\n\t\t\tconst formatter = new JSONFormatter(this.json);\n\t\t\tconst elementRef = formatter.render();\n\t\t\tthis.input.nativeElement.appendChild(elementRef);\n\t\t\tthis.elementRef = new ElementRef(elementRef);\n\t\t}\n\t}\n}\n","import { ChangeDetectorRef, OnDestroy, Pipe, PipeTransform, WrappedValue } from '@angular/core';\nimport { Observable, SubscriptionLike } from 'rxjs';\n\n@Pipe({\n\tname: 'customAsync',\n\tpure: false\n})\nexport class CustomAsyncPipe implements OnDestroy, PipeTransform {\n\n\tprivate subject: Observable<any> | null = null;\n\tprivate subscription: SubscriptionLike | null = null;\n\tprivate value: any = null;\n\tprivate cachedValue: any = null;\n\n\tconstructor(\n\t\tprivate changeDetector: ChangeDetectorRef\n\t) { }\n\n\ttransform(subject: Observable<any> | null | undefined): any {\n\t\treturn this.observableToValue(subject);\n\t}\n\n\tprivate observableToValue(subject: Observable<any> | null | undefined): any {\n\t\tif (subject !== this.subject) {\n\t\t\tif (this.subject) {\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t\tif (subject) {\n\t\t\t\tthis.subject = subject;\n\t\t\t\tthis.subscription = this.subject.subscribe((value: any) => {\n\t\t\t\t\t// console.log('CustomAsyncPipe.A', value);\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\tthis.changeDetector.markForCheck(); // mark pipe as dirty\n\t\t\t\t});\n\t\t\t\tthis.cachedValue = this.value; // ???\n\t\t\t\treturn this.value;\n\t\t\t}\n\t\t}\n\t\t// console.log('CustomAsyncPipe.B', this.value);\n\t\tif (this.cachedValue !== this.value) {\n\t\t\tthis.cachedValue = this.value;\n\t\t\treturn WrappedValue.wrap(this.value); // notify that value has changed\n\t\t}\n\t\treturn this.cachedValue; // return cachedValue\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this.subscription) {\n\t\t\tthis.subscription.unsubscribe();\n\t\t}\n\t\tthis.value = null;\n\t\tthis.cachedValue = null;\n\t\tthis.subscription = null;\n\t\tthis.subject = null;\n\t}\n\n\tngOnDestroy(): void {\n\t\tthis.dispose();\n\t}\n\n\tprivate _observableToValue(subject: Observable<any> | null | undefined): any {\n\t\tif (!this.subject) {\n\t\t\tif (subject) {\n\t\t\t\tthis.subject = subject;\n\t\t\t\tthis.subscription = this.subject.subscribe((value: any) => {\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\tthis.changeDetector.markForCheck(); // value has changed\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.cachedValue = this.value;\n\t\t\treturn this.value;\n\t\t}\n\t\tif (subject !== this.subject) {\n\t\t\tthis.dispose();\n\t\t\treturn this.transform(subject as any);\n\t\t}\n\t\tif (this.value === this.cachedValue) {\n\t\t\treturn this.cachedValue;\n\t\t}\n\t\tthis.cachedValue = this.value;\n\t\treturn WrappedValue.wrap(this.value); // value has changed\n\t}\n\n}\n","import { EventEmitter, Injectable, Injector } from '@angular/core';\nimport { BehaviorSubject, Observable, of, Subject } from 'rxjs';\nimport { catchError, filter, first, map, take, tap } from 'rxjs/operators';\nimport { ApiService } from '../api/api.service';\nimport { Label } from './label';\n\nexport class LabelKey {\n\tid?: string;\n\tvalue?: string;\n\tdefaultValue?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LabelService<T extends Label> extends ApiService<T> {\n\n\tget collection(): string {\n\t\treturn '/api/label';\n\t}\n\n\tprivate _language: any = new BehaviorSubject({});\n\tpublic readonly language: Observable<any> = this._language.asObservable();\n\tprivate _languages: BehaviorSubject<Array<any>> = new BehaviorSubject([]);\n\tpublic readonly languages: Observable<any[]> = this._languages.asObservable();\n\n\tprivate _lang: string;\n\tpublic get lang(): string {\n\t\treturn this._lang;\n\t}\n\tpublic set lang(lang: string) {\n\t\tif (lang !== this._lang) {\n\t\t\tthis._lang = lang;\n\t\t\tconst language = this._languages.getValue().find(x => x.lang === lang);\n\t\t\tthis._language.next(language);\n\t\t}\n\t}\n\n\tpublic events: EventEmitter<any> = new EventEmitter();\n\tpublic missingHandler?: Function;\n\tpublic cache: {} = {};\n\n\t// !!! new async pipe\n\tprivate collectedKeys: { [key: string]: LabelKey; } = {};\n\t// private cache: { [key: string]: string; } = {};\n\tprivate labels$: Subject<{ [key: string]: string; }> = new Subject();\n\tprivate emitter: EventEmitter<any> = new EventEmitter();\n\n\tconstructor(\n\t\tprotected injector: Injector,\n\t) {\n\t\tsuper(injector);\n\t\tthis._languages.next(this.config.languages);\n\t\tthis._lang = this.config.defaultLanguage;\n\t\tthis.getTranslation(this.lang).subscribe(x => {\n\t\t\t// console.log(x);\n\t\t});\n\t}\n\n\tpublic getTranslation(lang: string): Observable<{}> {\n\t\tif (!lang || !lang.trim()) {\n\t\t\treturn of(null);\n\t\t}\n\t\tthis.lang = lang;\n\t\tif (this.cache[lang]) {\n\t\t\treturn of(this.cache[lang]);\n\t\t} else {\n\t\t\treturn this.get({ lang }).pipe(\n\t\t\t\ttake(1),\n\t\t\t\tmap((x: Label[]) => {\n\t\t\t\t\tif (x[0]) {\n\t\t\t\t\t\tconst labels = x[0].labels;\n\t\t\t\t\t\tthis.cache[lang] = labels;\n\t\t\t\t\t\tthis.events.emit(labels);\n\t\t\t\t\t\treturn labels;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn of(null);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\t/*\n\t\t\t\ttap(x => {\n\t\t\t\t\t// this.logger.log(`found label matching \"${lang}\"`);\n\t\t\t\t})\n\t\t\t\t*/\n\t\t\t);\n\t\t}\n\t}\n\n\tpublic getLabel(key: string, defaultValue?: string, params?: any): string | any {\n\t\tlet value: string | null = null;\n\t\tlet labels: any = this.cache[this.lang];\n\t\tif (labels) {\n\t\t\tconst keys: string[] = key.split('.');\n\t\t\tlet k = keys.shift();\n\t\t\twhile (keys.length > 0 && labels[k]) {\n\t\t\t\tlabels = labels[k];\n\t\t\t\tk = keys.shift();\n\t\t\t}\n\t\t\tvalue = labels[k] || `{${k}}`;\n\t\t}\n\t\treturn this.parseLabel(value, key, defaultValue, params);\n\t}\n\n\tprivate parseLabel(value: string | null, key: string, defaultValue?: string, params?: any): string | any {\n\t\tif (value == null) {\n\t\t\tvalue = defaultValue;\n\t\t}\n\t\tif (value == null) {\n\t\t\treturn this.missingLabel(key);\n\t\t} else if (params) {\n\t\t\treturn this.parseParams(value, params);\n\t\t}\n\t\treturn value;\n\t}\n\n\tprivate missingLabel(key: string): string {\n\t\tif (this.missingHandler) {\n\t\t\treturn typeof this.missingHandler === 'function' ?\n\t\t\t\tthis.missingHandler(key) :\n\t\t\t\tthis.missingHandler;\n\t\t}\n\t\treturn key;\n\t}\n\n\tprivate parseParams(value: string, params: any): string {\n\t\tconst TEMPLATE_REGEXP: RegExp = /@\\s?([^{}\\s]*)\\s?/g; // /{{\\s?([^{}\\s]*)\\s?}}/g;\n\t\treturn value.replace(TEMPLATE_REGEXP, (text: string, key: string) => {\n\t\t\tconst replacer: string = params[key] as string;\n\t\t\treturn typeof replacer !== 'undefined' ? replacer : text;\n\t\t});\n\t}\n\n\t//\n\n\tgetKey(key: string, defaultValue?: string, params?: any): Observable<string> {\n\t\tif (this.cache.hasOwnProperty(key)) {\n\t\t\treturn of(this.cache[key]);\n\t\t} else {\n\t\t\tObject.defineProperty(this.collectedKeys, key, {\n\t\t\t\tvalue: { id: key, defaultValue: defaultValue },\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t});\n\t\t\tthis.cache[key] = null;\n\t\t}\n\t\treturn this.labels$.pipe(\n\t\t\tmap(items => items[key] || null),\n\t\t\tfilter(label => label !== null),\n\t\t\t// tap(label => console.log('getKey', key, label)),\n\t\t\tmap(label => this.parseLabel(label, key, defaultValue, params)),\n\t\t);\n\t}\n\n\tregister(): Observable<any> {\n\t\treturn this.emitter.pipe(\n\t\t\t// throttleTime(500),\n\t\t\ttap(() => {\n\t\t\t\tthis.collectKeys().pipe(\n\t\t\t\t\tfirst(),\n\t\t\t\t).subscribe((keys) => {\n\t\t\t\t\t// console.log('LabelService.collected', keys);\n\t\t\t\t});\n\t\t\t})\n\t\t);\n\t}\n\n\tcollect(): void {\n\t\tif (Object.keys(this.collectedKeys).length) {\n\t\t\tthis.emitter.emit();\n\t\t}\n\t}\n\n\tprivate collectKeys(): Observable<{ [key: string]: string; }> {\n\t\tconst keys = Object.keys(this.collectedKeys).map(x => this.collectedKeys[x]);\n\t\tthis.collectedKeys = {};\n\t\tif (keys.length) {\n\t\t\t// console.log('LabelService.collectKeys', JSON.stringify(keys));\n\t\t\treturn this.statePost(`/api/i18n/labels`, keys).pipe(\n\t\t\t\tmap((keys: LabelKey[]) => {\n\t\t\t\t\tconst items = {};\n\t\t\t\t\tkeys.forEach(x => items[x.id] = x.value || x.defaultValue);\n\t\t\t\t\treturn items;\n\t\t\t\t}),\n\t\t\t\ttap((items: { [key: string]: string; }) => {\n\t\t\t\t\tObject.assign(this.cache, items);\n\t\t\t\t\tthis.labels$.next(this.cache);\n\t\t\t\t\t// console.log('collectKeys', this.cache);\n\t\t\t\t}),\n\t\t\t\tcatchError(error => {\n\t\t\t\t\tconsole.log('LabelService.collectKeys.error', error);\n\t\t\t\t\treturn of({});\n\t\t\t\t}),\n\t\t\t);\n\t\t\t/*\n\t\t\treturn this.post(`/api/i18n/labels`, keys).pipe(\n\t\t\t\tmap((keys: LabelKey[]) => {\n\t\t\t\t\tconst items = {};\n\t\t\t\t\tkeys.forEach(x => items[x.id] = x.value || x.defaultValue);\n\t\t\t\t\treturn items;\n\t\t\t\t}),\n\t\t\t\ttap((items: { [key: string]: string; }) => {\n\t\t\t\t\tObject.assign(this.cache, items);\n\t\t\t\t\tthis.labels$.next(this.cache);\n\t\t\t\t\t// console.log('collectKeys', this.cache);\n\t\t\t\t}),\n\t\t\t);\n\t\t\t*/\n\t\t} else {\n\t\t\treturn of({});\n\t\t}\n\t}\n\n}\n\nexport function CustomTranslateLoader(injector: Injector) {\n\treturn new LabelService(injector);\n}\n\n","import { ChangeDetectorRef, Injectable, OnDestroy, Pipe, PipeTransform } from '@angular/core';\nimport { CustomAsyncPipe } from '../pipes/custom-async.pipe';\nimport { Label } from './label';\nimport { LabelService } from './label.service';\n\n@Pipe({\n\tname: 'labelAsync',\n\tpure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LabelAsyncPipe implements OnDestroy, PipeTransform {\n\n\tprivate asyncPipe: CustomAsyncPipe;\n\n\tconstructor(\n\t\tprivate changeDetector: ChangeDetectorRef,\n\t\tprivate labelService: LabelService<Label>,\n\t) {\n\t\tthis.asyncPipe = new CustomAsyncPipe(this.changeDetector);\n\t}\n\n\ttransform(key: string, text?: string, params?: any): string {\n\t\treturn this.asyncPipe.transform(this.labelService.getKey(key, text, params));\n\t}\n\n\tngOnDestroy(): void {\n\t\tthis.asyncPipe.dispose();\n\t}\n\n}\n","import { Directive, ElementRef, Input, OnInit } from '@angular/core';\nimport { takeUntil } from 'rxjs/operators';\nimport { DisposableComponent } from '../disposable/disposable.component';\nimport { Label } from './label';\nimport { LabelService } from './label.service';\n\n@Directive({\n\tselector: '[label]'\n})\nexport class LabelDirective extends DisposableComponent implements OnInit {\n\n\tkey: string;\n\tinnerHTML: string;\n\n\t/*\n\t@Input() set label(key: string) {\n\t\t// console.log('LabelDirective.label', this.key, this.labelParams, this.template, this.view);\n\t}\n\t*/\n\t@Input() label: string;\n\t@Input() labelParams: any;\n\n\tconstructor(\n\t\tprivate element: ElementRef,\n\t\tprivate labelService: LabelService<Label>,\n\t) {\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t\t// console.log('LabelDirective.ngOnInit', this.element.nativeElement.innerHTML);\n\t\tthis.labelService.getKey(this.label, this.element.nativeElement.innerHTML, this.labelParams).pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(label => {\n\t\t\tthis.element.nativeElement.innerHTML = label;\n\t\t\t// console.log('LabelDirective.ngOnInit', label);\n\t\t});\n\t\t// console.log('LabelDirective.ngOnInit', this.label, this.labelParams, this.template, this.view);\n\t}\n}\n","import { ChangeDetectorRef, Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { Label } from './label';\nimport { LabelService } from './label.service';\n\n@Pipe({\n\tname: 'label',\n\tpure: false,\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class LabelPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate ref: ChangeDetectorRef,\n\t\tprotected labelService: LabelService<Label>\n\t) {\n\t\tthis.labelService.events.subscribe(\n\t\t\tx => this.ref.markForCheck()\n\t\t);\n\t}\n\n\tpublic transform(key: string, text?: string, params?: any): string {\n\t\t// console.log(key, params);\n\t\t// return WrappedValue.wrap(this.val);\n\t\tconst label = this.labelService.getLabel(key, text, params);\n\t\t// console.log('label', label, this.labelService.cache);\n\t\treturn label;\n\t}\n\n}\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { Logger } from './logger';\n\n@Component({\n\tselector: 'ws-logger',\n\ttemplateUrl: './logger.component.html',\n\tstyleUrls: ['./logger.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\nexport class LoggerComponent implements OnInit {\n\tconstructor(public logger: Logger) { }\n\n\tngOnInit() {\n\t}\n}\n","import { EventEmitter, Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { tap } from 'rxjs/operators';\n\nexport class EventEntity {\n\ttype: string | number;\n\tdata?: any;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class EventDispatcherService {\n\n\tprivate emitter: EventEmitter<EventEntity>;\n\n\tconstructor() {\n\t\tthis.emitter = new EventEmitter<EventEntity>();\n\t}\n\n\temit(event: EventEntity): void {\n\t\treturn this.emitter.emit(event);\n\t}\n\n\tobserve(): Observable<EventEntity> {\n\t\treturn this.emitter.pipe(\n\t\t\ttap((event: EventEntity) => console.log('EventDispatcherService', event))\n\t\t);\n\t}\n\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { EntityService } from './entity.service';\nimport { MenuItem } from './menu-item';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class MenuService extends EntityService<MenuItem> {\n\n\tget collection(): string {\n\t\treturn '/api/menu';\n\t}\n\n\tconstructor(\n\t\tprotected injector: Injector,\n\t) {\n\t\tsuper(injector);\n\t}\n\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, NgZone, PLATFORM_ID } from '@angular/core';\nimport { from, fromEvent, Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\n// export class OnceEvent extends Event { }\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class OnceService {\n\n\tprivate uid: number = 0;\n\tprivate paths: string[] = [];\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate zone: NgZone,\n\t) { }\n\n\tscript(url: string, callback?: string | boolean): Observable<Event> {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\t// !!! this.zone.runOutsideAngular(() => {\n\t\t\tif (this.paths.indexOf(url) === -1) {\n\t\t\t\tthis.paths.push(url);\n\t\t\t\tlet callbackName: string;\n\t\t\t\tif (callback === true) {\n\t\t\t\t\tcallbackName = 'OnceCallback' + (++this.uid);\n\t\t\t\t\turl = url.split('{{callback}}').join(callbackName);\n\t\t\t\t} else {\n\t\t\t\t\tcallbackName = callback as string;\n\t\t\t\t}\n\t\t\t\tlet callback$: Observable<any>;\n\t\t\t\tconst element = document.createElement('script');\n\t\t\t\telement.type = 'text/javascript';\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback$ = from(\n\t\t\t\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\t\t\t\twindow[callbackName] = function (data) {\n\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\telement.async = true;\n\t\t\t\t\tcallback$ = fromEvent(element, 'load').pipe(\n\t\t\t\t\t\tmap(x => x as Event)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tconst scripts = document.getElementsByTagName('script');\n\t\t\t\tif (scripts.length) {\n\t\t\t\t\tconst script = scripts[scripts.length - 1];\n\t\t\t\t\tscript.parentNode.insertBefore(element, script.nextSibling);\n\t\t\t\t}\n\t\t\t\telement.src = url;\n\t\t\t\treturn callback$;\n\t\t\t} else {\n\t\t\t\treturn of(new Event('loaded!'));\n\t\t\t}\n\t\t\t// });\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { ConfigService } from '../config/config.service';\nimport { SegmentPipe } from './segment.pipe';\n\n@Pipe({\n\tname: 'asset',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class AssetPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate configService: ConfigService,\n\t\tprivate segment: SegmentPipe\n\t) { }\n\n\ttransform(data: any[] | string): string {\n\t\tif (typeof data === 'string' && (data.indexOf('http') === 0 || data.indexOf('/media/') === 0)) {\n\t\t\treturn data;\n\t\t} else {\n\t\t\tconst segments = this.segment.transform(data);\n\t\t\tsegments.unshift(this.configService.options.assets);\n\t\t\treturn segments.join('/');\n\t\t}\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { Image, ImageType } from '../models/image';\n\n@Pipe({\n\tname: 'image',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ImagePipe implements PipeTransform {\n\ttransform(images: Image[], type?: string, queryString?: string): string {\n\t\ttype = type || 'Default';\n\t\tqueryString = queryString ? `?${queryString}` : '';\n\t\tconst imageType: ImageType = ImageType[type] || ImageType.Default;\n\t\tlet image: Image = null;\n\t\tif (images && images.length) {\n\t\t\timage = images.find(i => i.type === imageType) || images[0];\n\t\t}\n\t\treturn image ? (image.url + queryString).replace(/ /g, '%20') : null;\n\t}\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { ConfigService } from '../config/config.service';\nimport { SegmentPipe } from './segment.pipe';\n\n@Pipe({\n\tname: 'public',\n\t// pure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class PublicPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate configService: ConfigService,\n\t\tprivate segment: SegmentPipe\n\t) { }\n\n\ttransform(data: any[] | string): string {\n\t\tconst segments = this.segment.transform(data);\n\t\tsegments.unshift(this.configService.options.public);\n\t\treturn segments.join('/');\n\t}\n\n}\n","\n\n\nimport { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { from, Observable, of } from 'rxjs';\nimport { concatMap, filter } from 'rxjs/operators';\nimport { ConfigService } from '../../config/config.service';\nimport { OnceService } from '../../once/once.service';\nimport { RouteService } from '../../routes/route.service';\nimport { LocalStorageService, StorageService } from '../../storage/storage.service';\n\nexport class FacebookConfig {\n\tpublic appId: number;\n\tpublic fields: string = 'id,name,first_name,last_name,email,gender,picture,cover,link';\n\tpublic scope: string = 'public_profile, email'; // publish_stream\n\tpublic tokenClient: string;\n\tpublic version: string = 'v2.10';\n}\n\nexport class FacebookAuthResponse {\n\taccessToken: string;\n\texpiresIn: number;\n\tsignedRequest: string;\n\tuserID: string;\n}\n\nexport class FacebookPictureData {\n\theight: number;\n\tis_silhouette: boolean;\n\turl: string;\n\twidth: number;\n}\n\nexport class FacebookPicture {\n\tdata: FacebookPictureData;\n}\n\nexport class FacebookUser {\n\temail: string;\n\tfirst_name: string;\n\tid: string;\n\tlast_name: string;\n\tname: string;\n\tpicture: FacebookPicture;\n\tauthResponse?: FacebookAuthResponse;\n\tfacebookToken?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class FacebookService {\n\n\tpublic authResponse: FacebookAuthResponse;\n\tpublic storage: StorageService;\n\tprivate options: FacebookConfig;\n\tprivate FB: any;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate storageService: LocalStorageService,\n\t\tprivate onceService: OnceService,\n\t\tprivate routeService: RouteService,\n\t) {\n\t\tthis.init();\n\t}\n\n\tinit(): void {\n\t\tif (!this.configService.options.plugins && !this.configService.options.plugins.facebook) {\n\t\t\tthrow new Error('FacebookService.error missing config object in environment.plugins.facebook');\n\t\t}\n\t\tthis.options = Object.assign(new FacebookConfig(), this.configService.options.plugins.facebook);\n\t\tthis.storage = this.storageService.tryGet();\n\t\tthis.authResponse = this.storage.get('facebook');\n\t\t// console.log('FacebookService.authResponse', this.authResponse);\n\t}\n\n\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\t*  call FacebookService.facebook on component OnInit to avoid popup blockers via asyncronous loading *\n\t* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n\tfacebook(): Observable<any> {\n\t\tif (isPlatformBrowser(this.platformId) && window.location.protocol.indexOf('https') !== -1) {\n\t\t\tif (this.FB) {\n\t\t\t\treturn of(this.FB);\n\t\t\t} else {\n\t\t\t\treturn this.onceService.script('//connect.facebook.net/' + this.routeService.currentLang + '/sdk.js', 'fbAsyncInit').pipe(\n\t\t\t\t\tconcatMap(x => {\n\t\t\t\t\t\t// console.log(x);\n\t\t\t\t\t\tconst FB = window['FB'];\n\t\t\t\t\t\tFB.init({\n\t\t\t\t\t\t\tappId: this.options.appId,\n\t\t\t\t\t\t\t// status: true,\n\t\t\t\t\t\t\tcookie: true,\n\t\t\t\t\t\t\txfbml: true,\n\t\t\t\t\t\t\tversion: this.options.version,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.FB = FB;\n\t\t\t\t\t\treturn of(FB);\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n\tstatus() {\n\t\treturn this.facebook().pipe(\n\t\t\tfilter(f => f !== null),\n\t\t\tconcatMap(f => {\n\t\t\t\treturn from(new Promise((resolve, reject) => {\n\t\t\t\t\tf.getLoginStatus((r) => {\n\t\t\t\t\t\tthis.authResponse = null;\n\t\t\t\t\t\tif (r.status === 'connected') {\n\t\t\t\t\t\t\tthis.authResponse = r.authResponse;\n\t\t\t\t\t\t\tthis.storage.set('facebook', r.authResponse);\n\t\t\t\t\t\t\tresolve(r);\n\t\t\t\t\t\t} else if (r.status === 'not_authorized') {\n\t\t\t\t\t\t\tthis.storage.delete('facebook');\n\t\t\t\t\t\t\treject(r);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treject(r);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { scope: this.options.scope });\n\t\t\t\t}));\n\t\t\t})\n\t\t);\n\t\t/*\n\t\treturn from(new Promise((resolve, reject) => {\n\t\t\tthis.facebook().subscribe(x => {\n\t\t\t\tx.getLoginStatus((r) => {\n\t\t\t\t\tthis.authResponse = null;\n\t\t\t\t\tif (r.status === 'connected') {\n\t\t\t\t\t\tthis.authResponse = r.authResponse;\n\t\t\t\t\t\tthis.storage.set('facebook', r.authResponse);\n\t\t\t\t\t\tresolve(r);\n\t\t\t\t\t} else if (r.status === 'not_authorized') {\n\t\t\t\t\t\tthis.storage.delete('facebook');\n\t\t\t\t\t\treject(r);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(r);\n\t\t\t\t\t}\n\t\t\t\t}, { scope: this.options.scope });\n\t\t\t});\n\t\t}));\n\t\t*/\n\t}\n\n\tlogin() {\n\t\treturn this.facebook().pipe(\n\t\t\tfilter(f => f !== null),\n\t\t\tconcatMap(f => {\n\t\t\t\treturn from(new Promise((resolve, reject) => {\n\t\t\t\t\tf.login((r) => {\n\t\t\t\t\t\tthis.authResponse = null;\n\t\t\t\t\t\tif (r.status === 'connected') {\n\t\t\t\t\t\t\tthis.authResponse = r.authResponse;\n\t\t\t\t\t\t\tthis.storage.set('facebook', r.authResponse);\n\t\t\t\t\t\t\tresolve(r);\n\t\t\t\t\t\t} else if (r.status === 'not_authorized') {\n\t\t\t\t\t\t\tthis.storage.delete('facebook');\n\t\t\t\t\t\t\treject(r);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treject(r);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { scope: this.options.scope });\n\t\t\t\t}));\n\t\t\t})\n\t\t);\n\t\t/*\n\t\treturn from(new Promise((resolve, reject) => {\n\t\t\tthis.facebook().subscribe(x => {\n\t\t\t\tx.login((r) => {\n\t\t\t\t\tthis.authResponse = null;\n\t\t\t\t\tif (r.status === 'connected') {\n\t\t\t\t\t\tthis.authResponse = r.authResponse;\n\t\t\t\t\t\tthis.storage.set('facebook', r.authResponse);\n\t\t\t\t\t\tresolve(r);\n\t\t\t\t\t} else if (r.status === 'not_authorized') {\n\t\t\t\t\t\tthis.storage.delete('facebook');\n\t\t\t\t\t\treject(r);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(r);\n\t\t\t\t\t}\n\t\t\t\t}, { scope: this.options.scope });\n\t\t\t});\n\t\t}));\n\t\t*/\n\t}\n\n\tlogout(): Observable<any> {\n\t\treturn this.facebook().pipe(\n\t\t\tfilter(f => f !== null),\n\t\t\tconcatMap(f => {\n\t\t\t\treturn from(new Promise((resolve, reject) => {\n\t\t\t\t\t// console.log('f', f);\n\t\t\t\t\tf.logout(r => {\n\t\t\t\t\t\tresolve(r);\n\t\t\t\t\t\tthis.storage.delete('facebook');\n\t\t\t\t\t});\n\t\t\t\t}));\n\t\t\t})\n\t\t);\n\t\t/*\n\t\treturn from(new Promise((resolve, reject) => {\n\t\t\tthis.facebook().subscribe(x => {\n\t\t\t\tx.logout(r => {\n\t\t\t\t\tresolve(r);\n\t\t\t\t\tthis.storage.delete('facebook');\n\t\t\t\t});\n\t\t\t});\n\t\t}));\n\t\t*/\n\t}\n\n\tgetMe(fields?: string): Observable<FacebookUser> {\n\t\treturn this.login().pipe(\n\t\t\tconcatMap(l => {\n\t\t\t\treturn from(new Promise((resolve, reject) => {\n\t\t\t\t\tfields = fields || this.options.fields;\n\t\t\t\t\tthis.FB.api('/me', {\n\t\t\t\t\t\tfields: fields,\n\t\t\t\t\t\taccessToken: this.options.tokenClient,\n\t\t\t\t\t}, (r) => {\n\t\t\t\t\t\tif (!r || r.error) {\n\t\t\t\t\t\t\tconst error = r ? r.error : 'error';\n\t\t\t\t\t\t\tconsole.log('FacebookService.getMe.error', error);\n\t\t\t\t\t\t\treject(r.error);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst user = r as FacebookUser;\n\t\t\t\t\t\t\tuser.authResponse = this.authResponse;\n\t\t\t\t\t\t\tuser.facebookToken = this.authResponse.accessToken;\n\t\t\t\t\t\t\t// console.log('FacebookService.getMe.success', user);\n\t\t\t\t\t\t\tresolve(user);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}));\n\t\t\t})\n\t\t);\n\t}\n\n}\n","\nimport { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, NgZone, PLATFORM_ID } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { first, map } from 'rxjs/operators';\nimport { ConfigService } from '../../config/config.service';\nimport { Logger } from '../../logger/logger';\nimport { OnceService } from '../../once/once.service';\n\nexport class GoogleTagManagerPageViewEvent {\n\tdataLayer: any[];\n\turl: string;\n}\n\nexport class GoogleTagManagerConfig {\n\tid: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class GoogleTagManagerService {\n\n\tpublic options: GoogleTagManagerConfig;\n\n\tprivate dataLayer: any[];\n\tprivate dataLayer$: Observable<any[]>;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate zone: NgZone,\n\t\tprivate onceService: OnceService,\n\t\tprivate logger: Logger,\n\t) {\n\t\tthis.init();\n\t}\n\n\tprivate init(): void {\n\t\tif (!this.configService.options.plugins && !this.configService.options.plugins.googleTagManager) {\n\t\t\tthrow new Error('GoogleTagManagerService.error missing config object in environment.plugins.googleTagManager');\n\t\t}\n\t\tthis.options = Object.assign(new GoogleTagManagerConfig(), this.configService.options.plugins.googleTagManager);\n\t}\n\n\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\t*  call GoogleTagManagerConfig.once() on app component OnInit *\n\t* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n\tonce(): Observable<any[]> {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tif (this.dataLayer) {\n\t\t\t\treturn of(this.dataLayer);\n\t\t\t} else if (this.dataLayer$) {\n\t\t\t\treturn this.dataLayer$;\n\t\t\t} else {\n\t\t\t\twindow['dataLayer'] = window['dataLayer'] || [];\n\t\t\t\tconst id = this.options.id;\n\t\t\t\tconst src = `https://www.googletagmanager.com/gtm.js?id=${id}`;\n\t\t\t\tconst dataLayer = window['dataLayer'];\n\t\t\t\tdataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\n\t\t\t\t// console.log('GoogleTagManagerConfig.once', src, dataLayer);\n\t\t\t\tthis.dataLayer$ = this.onceService.script(src).pipe(\n\t\t\t\t\tmap(x => {\n\t\t\t\t\t\t// console.log('dataLayer', dataLayer, x);\n\t\t\t\t\t\tthis.dataLayer = dataLayer;\n\t\t\t\t\t\treturn dataLayer;\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn this.dataLayer$;\n\t\t\t}\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n\tpush(payload: any): void {\n\t\tthis.zone.runOutsideAngular(() => {\n\t\t\tif (this.dataLayer) {\n\t\t\t\tthis.dataLayer.push(payload);\n\t\t\t\tthis.logger.log('GoogleTagManagerConfig.push', payload);\n\t\t\t} else {\n\t\t\t\tthis.once().pipe(\n\t\t\t\t\tfirst(),\n\t\t\t\t).subscribe(dataLayer => {\n\t\t\t\t\tif (this.dataLayer) {\n\t\t\t\t\t\tthis.dataLayer.push(payload);\n\t\t\t\t\t\tthis.logger.log('GoogleTagManagerConfig.push', payload);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n\n/*\n<!-- Google Tag Manager -->\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-TS2H6VG');</script>\n<!-- End Google Tag Manager -->\n*/\n\n/*\n<!-- after <body> -->\n<!-- Google Tag Manager (noscript) -->\n<noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-TS2H6VG\"\nheight=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe></noscript>\n<!-- End Google Tag Manager (noscript) -->\n*/\n\n/*\nwindow.dataLayer = window.dataLayer || [];\n window.dataLayer.push({\n 'event': 'Pageview',\n 'url': 'https://www.example.com/something/contact-us'\n });\n*/\n\n\n","import { isPlatformBrowser } from '@angular/common';\nimport { AfterViewInit, Component, EventEmitter, Inject, Output, PLATFORM_ID } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\nimport { filter, takeUntil } from 'rxjs/operators';\nimport { ConfigService } from '../../config/config.service';\nimport { DisposableComponent } from '../../disposable/disposable.component';\nimport { GoogleTagManagerService } from './google-tag-manager.service';\n\n@Component({\n\tselector: 'ws-google-tag-manager',\n\ttemplate: `\n\t<!-- Google Tag Manager (noscript) -->\n\t\t<noscript *ngIf=\"useIframe && dataLayer\">\n\t\t\t<iframe [src]=\"iframeUrl | safeUrl\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>\n\t\t</noscript>\n\t<!-- End Google Tag Manager (noscript) -->`,\n})\n\nexport class GoogleTagManagerComponent extends DisposableComponent implements AfterViewInit {\n\n\tuseIframe: boolean = true;\n\tid: string;\n\tiframeUrl: string;\n\tdataLayer: any[];\n\n\t@Output() public pageView = new EventEmitter();\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate router: Router,\n\t\tprivate googleTagManager: GoogleTagManagerService,\n\t) {\n\t\tsuper();\n\t}\n\n\tngAfterViewInit() {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tthis.router.events.pipe(\n\t\t\t\ttakeUntil(this.unsubscribe),\n\t\t\t\tfilter(e => e instanceof NavigationEnd),\n\t\t\t).subscribe((e: NavigationEnd) => {\n\t\t\t\tconst url = `${this.configService.options.origin}${e.urlAfterRedirects}`;\n\t\t\t\t// console.log('GoogleTagManagerComponent.NavigationEnd', e.id, e.url, e.urlAfterRedirects, url);\n\t\t\t\tif (this.dataLayer) {\n\t\t\t\t\tthis.pageView.emit({ dataLayer: this.dataLayer, url });\n\t\t\t\t} else {\n\t\t\t\t\tthis.googleTagManager.once().pipe(\n\t\t\t\t\t\ttakeUntil(this.unsubscribe)\n\t\t\t\t\t).subscribe(dataLayer => {\n\t\t\t\t\t\t// console.log('dataLayer', dataLayer);\n\t\t\t\t\t\tthis.id = this.googleTagManager.options.id;\n\t\t\t\t\t\tthis.iframeUrl = `https://www.googletagmanager.com/ns.html?id=${this.id}`;\n\t\t\t\t\t\tthis.dataLayer = dataLayer;\n\t\t\t\t\t\tthis.pageView.emit({ dataLayer: this.dataLayer, url });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n}\n","\n\n\nimport { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { from, Observable, of } from 'rxjs';\nimport { concatMap } from 'rxjs/operators';\nimport { ConfigService } from '../../config/config.service';\nimport { OnceService } from '../../once/once.service';\nimport { LocalStorageService, StorageService } from '../../storage/storage.service';\n\nexport class GoogleConfig {\n\tpublic clientId: string;\n\tpublic cookiepolicy?: string = 'single_host_origin';\n\tpublic scope?: string = 'profile email';\n\tpublic fetch_basic_profile?: boolean = true;\n\tpublic ux_mode?: string = 'popup';\n}\n\nexport class GoogleAuthResponse {\n\ttoken_type: string;\n\taccess_token: string;\n\tscope: string;\n\tlogin_hint: string;\n\texpires_in: number;\n\texpires_at: number;\n\tfirst_issued_at: number;\n\tid_token: string;\n\tidpId: string;\n\tsignedRequest: string;\n\tuserID: string;\n}\n\nexport class GoogleUser {\n\temail: string;\n\tfirstName: string;\n\tid: string;\n\tlastName: string;\n\tname: string;\n\tpicture: string;\n\tauthResponse?: GoogleAuthResponse;\n\tgoogleToken?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class GoogleService {\n\n\tpublic authResponse: GoogleAuthResponse;\n\tpublic storage: StorageService;\n\tprivate options: GoogleConfig;\n\tprivate gapi: any;\n\tprivate auth2: any;\n\tprivate instance: any;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate storageService: LocalStorageService,\n\t\tprivate onceService: OnceService,\n\t) {\n\t\tthis.init();\n\t}\n\n\tinit(): void {\n\t\tif (!this.configService.options.plugins && !this.configService.options.plugins.google) {\n\t\t\tthrow new Error('GoogleService.error missing config object in environment.plugins.google');\n\t\t}\n\t\tthis.options = Object.assign(new GoogleConfig(), this.configService.options.plugins.google);\n\t\tthis.storage = this.storageService.tryGet();\n\t\tthis.authResponse = this.storage.get('google');\n\t\t// console.log('GoogleService.authResponse', this.authResponse);\n\t}\n\n\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\t*  call GoogleService.google on component OnInit to avoid popup blockers via asyncronous loading *\n\t* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n\tprivate google(): Observable<any> {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\treturn new Observable().pipe(x => {\n\t\t\t\tif (this.gapi) {\n\t\t\t\t\treturn of(this.gapi);\n\t\t\t\t} else {\n\t\t\t\t\treturn this.once();\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n\tgetMe() {\n\t\treturn this.login().pipe(\n\t\t\tconcatMap(x => {\n\t\t\t\tconst profile = this.instance.currentUser.get().getBasicProfile();\n\t\t\t\tconst user = {\n\t\t\t\t\tid: profile.getId(),\n\t\t\t\t\tname: profile.getName(),\n\t\t\t\t\tfirstName: profile.getGivenName(),\n\t\t\t\t\tlastName: profile.getFamilyName(),\n\t\t\t\t\tpicture: profile.getImageUrl(),\n\t\t\t\t\temail: profile.getEmail(),\n\t\t\t\t\tauthResponse: this.authResponse,\n\t\t\t\t\tgoogleToken: this.authResponse.access_token,\n\t\t\t\t} as GoogleUser;\n\t\t\t\treturn of(user);\n\t\t\t})\n\t\t);\n\t}\n\n\tlogin() {\n\t\treturn this.auth2Instance().pipe(\n\t\t\tconcatMap(x => {\n\t\t\t\treturn this.signin();\n\t\t\t})\n\t\t);\n\t}\n\n\tlogout() {\n\t\treturn this.auth2Instance().pipe(\n\t\t\tconcatMap(x => {\n\t\t\t\treturn from(\n\t\t\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\t\t\tif (this.instance.isSignedIn && this.instance.isSignedIn.get()) {\n\t\t\t\t\t\t\tthis.instance.signOut().then((signed) => {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t})\n\t\t);\n\t}\n\n\tprivate once(): Observable<any> {\n\t\treturn this.onceService.script('https://apis.google.com/js/api:client.js?onload={{callback}}', true).pipe(\n\t\t\tconcatMap(x => {\n\t\t\t\tthis.gapi = window['gapi'];\n\t\t\t\treturn of(this.gapi);\n\t\t\t})\n\t\t);\n\t}\n\n\tprivate getAuth2() {\n\t\treturn new Observable().pipe(x => {\n\t\t\tif (this.auth2) {\n\t\t\t\treturn of(this.auth2);\n\t\t\t} else {\n\t\t\t\treturn this.google().pipe(\n\t\t\t\t\tconcatMap(x => {\n\t\t\t\t\t\tif (this.gapi.auth2) {\n\t\t\t\t\t\t\treturn this.auth2init();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn from(\n\t\t\t\t\t\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\t\t\t\t\t\tthis.gapi.load('auth2', () => {\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t).pipe(\n\t\t\t\t\t\t\t\tconcatMap(x => {\n\t\t\t\t\t\t\t\t\treturn this.auth2init();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate signin() {\n\t\treturn from(\n\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\tconst readAccessToken = () => {\n\t\t\t\t\t// console.log('GoogleLogin.readAccessToken');\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst user = this.instance.currentUser.get().getAuthResponse(true);\n\t\t\t\t\t\t// console.log('GoogleLogin.readAccessToken.success', user);\n\t\t\t\t\t\tthis.authResponse = user;\n\t\t\t\t\t\tthis.storage.set('google', user);\n\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\tcode: user.access_token,\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('GoogleLogin.readAccessToken.error', error);\n\t\t\t\t\t\tthis.storage.delete('google');\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (this.instance.isSignedIn && this.instance.isSignedIn.get()) {\n\t\t\t\t\treadAccessToken();\n\t\t\t\t} else {\n\t\t\t\t\tthis.instance.signIn({\n\t\t\t\t\t\tscope: 'profile email',\n\n\t\t\t\t\t}).then((signed) => {\n\t\t\t\t\t\treadAccessToken();\n\n\t\t\t\t\t}, (error) => {\n\t\t\t\t\t\tthis.storage.delete('google');\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tprivate auth2init() {\n\t\treturn from(\n\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\tthis.gapi.auth2.init({\n\t\t\t\t\tclient_id: this.options.clientId,\n\t\t\t\t\tcookiepolicy: 'single_host_origin',\n\t\t\t\t\tscope: 'profile email',\n\t\t\t\t\tfetch_basic_profile: true,\n\t\t\t\t\tux_mode: 'popup',\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.auth2 = this.gapi.auth2;\n\t\t\t\t\t// console.log('Auth2Init.success', this.auth2);\n\t\t\t\t\tresolve(this.auth2);\n\t\t\t\t}, reject);\n\t\t\t})\n\t\t);\n\t}\n\n\tpublic auth2Instance() {\n\t\tif (this.instance) {\n\t\t\treturn of(this.instance);\n\t\t} else {\n\t\t\treturn this.getAuth2().pipe(\n\t\t\t\tconcatMap(x => {\n\t\t\t\t\tthis.instance = this.auth2.getAuthInstance();\n\t\t\t\t\treturn of(this.instance);\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n}\n","import { ElementRef, Injectable } from '@angular/core';\n\n/*\nimport { isPlatformBrowser } from '@angular/common';\nimport { ElementRef, Inject, Injectable, NgZone, PLATFORM_ID } from '@angular/core';\nimport mapboxgl from 'mapbox-gl/dist/mapbox-gl';\nimport { fromEvent, Observable, of } from 'rxjs';\nimport { concatMap } from 'rxjs/operators';\n*/\n\nexport class MapboxConfig {\n\tpublic accessToken?: string;\n\tpublic style?: string;\n}\n\nexport class MapboxMapOptions {\n\tpublic element: ElementRef;\n\tpublic style?: string;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class MapboxService {\n\n\t/*\n\tprivate options: MapboxConfig;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate zone: NgZone,\n\t) {\n\t\tthis.init();\n\t}\n\n\tinit(): void {\n\t\tif (!this.configService.options.plugins && !this.configService.options.plugins.mapbox) {\n\t\t\tthrow new Error('MapboxService.error missing config object in environment.plugins.mapbox');\n\t\t}\n\t\tthis.options = Object.assign(new MapboxConfig(), this.configService.options.plugins.mapbox);\n\t}\n\n\tgetMap(options: MapboxMapOptions): Observable<mapboxgl.Map> {\n\t\treturn this.zone.runOutsideAngular(() => {\n\t\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\t\tmapboxgl.accessToken = this.options.accessToken;\n\t\t\t\toptions.style = options.style || this.options.style || 'mapbox://styles/mapbox/streets-v10';\n\t\t\t\tconst map = new mapboxgl.Map({\n\t\t\t\t\tcontainer: options.element.nativeElement,\n\t\t\t\t\tstyle: options.style\n\t\t\t\t});\n\t\t\t\tconst source = fromEvent(map, 'load').pipe(\n\t\t\t\t\tconcatMap(() => {\n\t\t\t\t\t\tmap.resize();\n\t\t\t\t\t\treturn of(map);\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn source;\n\t\t\t} else {\n\t\t\t\treturn of(null);\n\t\t\t}\n\t\t});\n\t}\n\t*/\n\n}\n","\nimport { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { from, Observable, of } from 'rxjs';\nimport { first, map, mergeMap } from 'rxjs/operators';\nimport { ConfigService } from '../../config/config.service';\nimport { OnceService } from '../../once/once.service';\n\nexport class PayPalConfigStyle {\n\tlabel?: string; // label: string\n\tsize?: string; // size: small | medium | large | responsive\n\tshape?: string;   // shape: pill | rect\n\tcolor?: string;   // color: gold | blue | silver | black\n}\n\nexport class PayPalConfigClient {\n\tsandbox: string;\n\tproduction: string;\n}\n\nexport class PayPalConfig {\n\tenv: string;\n\tstyle?: PayPalConfigStyle;\n\tclient: PayPalConfigClient;\n\tcommit?: boolean; // Show the buyer a 'Pay Now' button in the checkout flow\n\tsandboxFacilitator?: string;\n\t//\n\tpayment?: Function;\n\tonAuthorize?: Function;\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class PayPalService {\n\n\tpublic options: PayPalConfig;\n\tprivate paypal: any;\n\tprivate paypal$: Observable<any>;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate onceService: OnceService,\n\t) {\n\t\tthis.init();\n\t}\n\n\tprivate init(): void {\n\t\tif (!this.configService.options.plugins && !this.configService.options.plugins.paypal) {\n\t\t\tthrow new Error('PayPalService.error missing config object in environment.plugins.paypal');\n\t\t}\n\t\tthis.options = Object.assign(new PayPalConfig(), this.configService.options.plugins.paypal);\n\t}\n\n\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\t*  call PayPalConfig.once() on app component OnInit *\n\t* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n\tonce(): Observable<any> {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tif (this.paypal) {\n\t\t\t\treturn of(this.paypal);\n\t\t\t} else if (this.paypal$) {\n\t\t\t\treturn this.paypal$;\n\t\t\t} else {\n\t\t\t\tconst src = `https://www.paypalobjects.com/api/checkout.js`;\n\t\t\t\t// console.log('PayPalConfig.once', src);\n\t\t\t\tthis.paypal$ = this.onceService.script(src).pipe(\n\t\t\t\t\tmap(x => {\n\t\t\t\t\t\tthis.paypal = window['paypal'];\n\t\t\t\t\t\treturn this.paypal;\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn this.paypal$;\n\t\t\t}\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n\trender(options: any, selector?: string): Observable<any[]> {\n\t\tselector = selector || '#paypal-button';\n\t\treturn this.once().pipe(\n\t\t\tmergeMap(paypal => {\n\t\t\t\tpaypal.Button.render(this.getOptions(paypal, options), selector);\n\t\t\t\treturn of(paypal);\n\t\t\t})\n\t\t);\n\t}\n\n\tprivate getOptions(paypal, options): PayPalConfig {\n\t\tconst payload = Object.assign(this.options, options);\n\t\tpayload.payment = (data, actions) => {\n\t\t\treturn new paypal.Promise((resolve, reject) => {\n\t\t\t\tif (options.payment) {\n\t\t\t\t\toptions.payment().pipe(\n\t\t\t\t\t\tfirst(),\n\t\t\t\t\t\tmergeMap(payload => {\n\t\t\t\t\t\t\treturn from(actions.payment.create(payload));\n\t\t\t\t\t\t})\n\t\t\t\t\t).subscribe(\n\t\t\t\t\t\tsuccess => resolve(success), // actions.payment.create(success)\n\t\t\t\t\t\terror => reject(error)\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('PayPalService.payment callback not setted');\n\t\t\t\t\treject(null);\n\t\t\t\t}\n\t\t\t\t// Make an ajax call to get the Payment ID. This should call your back-end,\n\t\t\t\t// which should invoke the PayPal Payment Create api to retrieve the Payment ID.\n\t\t\t\t// When you have a Payment ID, you need to call the `resolve` method, e.g `resolve(data.paymentID)`\n\t\t\t\t// Or, if you have an error from your server side, you need to call `reject`, e.g. `reject(err)`\n\t\t\t\t// jQuery.post('/my-api/create-payment')\n\t\t\t\t// .done(function(data) { resolve(data.paymentID); })\n\t\t\t\t// .fail(function(err)  { reject(err); });\n\t\t\t});\n\t\t};\n\t\tpayload.onAuthorize = (data, actions) => {\n\t\t\tif (options.onAuthorize) {\n\t\t\t\treturn actions.payment.execute().then(\n\t\t\t\t\tpayment => options.onAuthorize(payment, null),\n\t\t\t\t\terror => options.onAuthorize(null, error)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconsole.log('PayPalService.onAuthorize callback not setted');\n\t\t\t}\n\t\t};\n\t\treturn payload;\n\t}\n\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { AfterViewInit, Component, Inject, Input, PLATFORM_ID } from '@angular/core';\nimport { takeUntil } from 'rxjs/operators';\nimport { DisposableComponent } from '../../disposable/disposable.component';\nimport { PayPalConfig, PayPalService } from './paypal.service';\n\n@Component({\n\tselector: 'ws-paypal-widget-component',\n\ttemplate: `<div id=\"#paypal-widget-button\"></div>`,\n})\n\nexport class PayPalWidgetComponent extends DisposableComponent implements AfterViewInit {\n\n\t@Input() paypalOptions: PayPalConfig;\n\tloaded: boolean;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate paypalService: PayPalService,\n\t) {\n\t\tsuper();\n\t}\n\n\tngAfterViewInit() {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tthis.paypalService.render(this.paypalOptions, '#paypal-widget-button').pipe(\n\t\t\t\ttakeUntil(this.unsubscribe)\n\t\t\t).subscribe(paypal => {\n\t\t\t\t// console.log('PayPalWidgetComponent.rendered', paypal)\n\t\t\t});\n\t\t}\n\t}\n\n}\n","\nimport { isPlatformBrowser } from '@angular/common';\nimport { Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { ConfigService } from '../../config/config.service';\nimport { OnceService } from '../../once/once.service';\n\nexport class TrustPilotConfig {\n\tbusinessunitId: string = '58e253ab0000ff00059fc0fe';\n\tbusinessunitName: string = 'www.eurospin-viaggi.it';\n}\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class TrustPilotService {\n\n\tpublic options: TrustPilotConfig;\n\tprivate Trustpilot: any;\n\tprivate Trustpilot$: Observable<any>;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate onceService: OnceService,\n\t) {\n\t\tthis.init();\n\t}\n\n\tprivate init(): void {\n\t\tif (!this.configService.options.plugins && !this.configService.options.plugins.trustPilot) {\n\t\t\tthrow new Error('TrustPilotService.error missing config object in environment.plugins.trustPilot');\n\t\t}\n\t\tthis.options = Object.assign(new TrustPilotConfig(), this.configService.options.plugins.trustPilot);\n\t}\n\n\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\t*  call TrustPilotConfig.once() on app component OnInit *\n\t* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n\n\tonce(): Observable<any> {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tif (this.Trustpilot) {\n\t\t\t\treturn of(this.Trustpilot);\n\t\t\t} else if (this.Trustpilot$) {\n\t\t\t\treturn this.Trustpilot$;\n\t\t\t} else {\n\t\t\t\tconst src = `https://widget.trustpilot.com/bootstrap/v5/tp.widget.bootstrap.min.js`;\n\t\t\t\t// console.log('TrustPilotConfig.once', src);\n\t\t\t\tthis.Trustpilot$ = this.onceService.script(src).pipe(\n\t\t\t\t\tmap(x => {\n\t\t\t\t\t\tthis.Trustpilot = window['Trustpilot'];\n\t\t\t\t\t\treturn this.Trustpilot;\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn this.Trustpilot$;\n\t\t\t}\n\t\t} else {\n\t\t\treturn of(null);\n\t\t}\n\t}\n\n}\n","import { isPlatformBrowser } from '@angular/common';\nimport { AfterViewInit, Component, ElementRef, Inject, Input, PLATFORM_ID, ViewEncapsulation } from '@angular/core';\nimport { takeUntil } from 'rxjs/operators';\nimport { ConfigService } from '../../config/config.service';\nimport { DisposableComponent } from '../../disposable/disposable.component';\nimport { TrustPilotConfig, TrustPilotService } from './trustpilot.service';\n\nexport class TrustPilotWidgetOptions {\n\ttemplateId?: string;\n\tbusinessunitId?: string;\n\tbusinessunitName?: string;\n\tlocale?: string = 'it-IT';\n\tsku?: string;\n\tstyleHeight?: string = '350px';\n\tstyleWidth?: string = '100%';\n\ttheme?: string = 'light';\n\tgroup?: string = 'on';\n\tstars?: string = '1,2,3,4,5';\n\n\tconstructor(\n\t\toptions?: TrustPilotWidgetOptions,\n\t) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t}\n\n\tstatic newFromConfig(options?: TrustPilotConfig): TrustPilotWidgetOptions {\n\t\treturn new TrustPilotWidgetOptions(options);\n\t}\n\n\tset?(options?: TrustPilotWidgetOptions): TrustPilotWidgetOptions {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t}\n\t\treturn this;\n\t}\n}\n\n@Component({\n\tselector: 'ws-trustpilot-widget-component',\n\ttemplateUrl: './trustpilot-widget.component.html',\n\tstyleUrls: ['./trustpilot-widget.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\n\nexport class TrustPilotWidgetComponent extends DisposableComponent implements AfterViewInit {\n\n\tloaded: boolean;\n\ttrustPilotOptions: TrustPilotConfig;\n\t@Input() options?: TrustPilotWidgetOptions;\n\t@Input() sku?: string;\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string,\n\t\tprivate configService: ConfigService,\n\t\tprivate elementRef: ElementRef,\n\t\tprivate trustPilot: TrustPilotService,\n\t) {\n\t\tsuper();\n\t\tthis.init();\n\t}\n\n\tprivate init(): void {\n\t\tif (!this.configService.options.plugins && !this.configService.options.plugins.trustPilot) {\n\t\t\tthrow new Error('TrustPilotService.error missing config object in environment.plugins.trustPilot');\n\t\t}\n\t\tthis.trustPilotOptions = this.configService.options.plugins.trustPilot;\n\t\tthis.options = new TrustPilotWidgetOptions(this.trustPilotOptions);\n\t}\n\n\tngAfterViewInit() {\n\t\t// console.log('TrustPilotWidgetComponent.ngOnInit', this.options, this.loaded);\n\t\tif (isPlatformBrowser(this.platformId) && this.elementRef.nativeElement.children.length) { // && environment.production\n\t\t\tif (!this.loaded) {\n\t\t\t\tthis.trustPilot.once().pipe(\n\t\t\t\t\ttakeUntil(this.unsubscribe)\n\t\t\t\t).subscribe(Trustpilot => {\n\t\t\t\t\tTrustpilot.loadFromElement(this.elementRef.nativeElement.firstElementChild);\n\t\t\t\t\tthis.loaded = true;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { RouteService } from './route.service';\n\n@Pipe({\n\tname: 'route',\n\tpure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class RoutePipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate routeService: RouteService,\n\t) { }\n\n\ttransform(data: any[] | string): string[] {\n\t\treturn this.routeService.toRoute(data);\n\t}\n\n}\n","import { EventEmitter, Injectable } from '@angular/core';\nimport { Observable, of, Subject } from 'rxjs';\nimport { filter, first, map, tap } from 'rxjs/operators';\nimport { DocumentIndex } from '../models/document';\nimport { EntityService } from '../models/entity.service';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SlugService extends EntityService<DocumentIndex> {\n\n\tprivate collectedKeys: { [key: string]: string; } = {};\n\tprivate cache: { [key: string]: string[]; } = {};\n\tprivate slugs$: Subject<{ [key: string]: string[]; }> = new Subject();\n\tprivate emitter: EventEmitter<any> = new EventEmitter();\n\n\tget collection(): string {\n\t\treturn `/api/slug`;\n\t}\n\n\tgetKey(key: string): Observable<string[]> {\n\t\tif (this.cache.hasOwnProperty(key)) {\n\t\t\treturn of(this.cache[key]);\n\t\t} else {\n\t\t\t// console.log('SlugService.getKey', key);\n\t\t\tObject.defineProperty(this.collectedKeys, key, {\n\t\t\t\tvalue: key,\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t});\n\t\t\tthis.cache[key] = null;\n\t\t}\n\t\t// return observable of key\n\t\treturn this.slugs$.pipe(\n\t\t\tmap(items => items[key]),\n\t\t\tfilter(item => item !== null),\n\t\t);\n\t}\n\n\tregister(): Observable<any> {\n\t\treturn this.emitter.pipe(\n\t\t\t// throttleTime(500),\n\t\t\ttap(() => {\n\t\t\t\tthis.collectKeys().pipe(\n\t\t\t\t\tfirst(),\n\t\t\t\t).subscribe((keys) => {\n\t\t\t\t\t// console.log('SlugService.collected', keys);\n\t\t\t\t});\n\t\t\t})\n\t\t);\n\t}\n\n\tcollect(): void {\n\t\tif (Object.keys(this.collectedKeys).length) {\n\t\t\tthis.emitter.emit();\n\t\t}\n\t}\n\n\tprivate getSlugs(keys: string[]): Observable<DocumentIndex[]> {\n\t\tkeys = keys || [];\n\t\treturn this.statePost(keys).pipe(\n\t\t\t// tap(items => console.log(items)),\n\t\t);\n\t}\n\n\tprivate collectKeys(): Observable<{ [key: string]: string; }> {\n\t\tthis.slugs$.next(this.cache);\n\t\tconst keys = Object.keys(this.collectedKeys);\n\t\tthis.collectedKeys = {};\n\t\treturn this.getSlugs(keys).pipe(\n\t\t\tmap((items: DocumentIndex[]) => {\n\t\t\t\tconst dictionary = {};\n\t\t\t\titems.forEach(x => dictionary[x.mnemonic] = [x.slug]);\n\t\t\t\treturn dictionary;\n\t\t\t}),\n\t\t\ttap((dictionary: { [key: string]: string; }) => {\n\t\t\t\tObject.assign(this.cache, dictionary);\n\t\t\t\tthis.slugs$.next(this.cache);\n\t\t\t})\n\t\t);\n\t}\n\n}\n","import { ChangeDetectorRef, Injectable, OnDestroy, Pipe, PipeTransform } from '@angular/core';\nimport { CustomAsyncPipe } from '../pipes/custom-async.pipe';\nimport { RoutePipe } from '../routes/route.pipe';\nimport { SlugService } from './slug.service';\n\n@Pipe({\n\tname: 'slugAsync',\n\tpure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SlugAsyncPipe implements OnDestroy, PipeTransform {\n\n\tprivate asyncPipe: CustomAsyncPipe;\n\n\tconstructor(\n\t\tprivate changeDetector: ChangeDetectorRef,\n\t\tprivate slugService: SlugService,\n\t\tprivate routePipe: RoutePipe,\n\t) {\n\t\tthis.asyncPipe = new CustomAsyncPipe(this.changeDetector);\n\t}\n\n\ttransform(key: string, segments?: string[]): string[] {\n\t\tlet slugs = this.routePipe.transform(this.asyncPipe.transform(this.slugService.getKey(key)));\n\t\t// console.log('SlugAsyncPipe.transform', key, slugs);\n\t\tif (slugs && segments) {\n\t\t\tslugs = slugs.concat(segments);\n\t\t}\n\t\treturn slugs;\n\t}\n\n\tngOnDestroy(): void {\n\t\tthis.asyncPipe.dispose();\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { SlugService } from './slug.service';\n\n@Pipe({\n\tname: 'slug',\n\tpure: false\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SlugPipe implements PipeTransform {\n\n\tconstructor(\n\t\t// private routeService: RouteService,\n\t\tprivate slugService: SlugService\n\t) { }\n\n\ttransform(key: string): Observable<string[]> {\n\t\treturn this.slugService.getKey(key);\n\t\t// return this.async.transform<any>(this.slugService.getKey(key));\n\t\t// return this.routeService.toSlug(key);\n\t}\n\n}\n","import { ChangeDetectorRef, Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { TranslateService } from './translate.service';\n\n@Pipe({\n\tname: 'translate',\n\tpure: false,\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class TranslatePipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate ref: ChangeDetectorRef,\n\t\tprotected translateService: TranslateService\n\t) {\n\t\t// this.translateService.events.subscribe(\n\t\t// \tx => this.ref.markForCheck()\n\t\t// );\n\t}\n\n\tpublic transform(key: string, params?: { value: any }): string {\n\t\t// const label = this.translateService.getLabel(key, text, params);\n\t\treturn key;\n\t}\n\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n\tname: 'safeStyle'\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SafeStylePipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate sanitizer: DomSanitizer\n\t) { }\n\n\ttransform(style: string) {\n\t\treturn this.sanitizer.bypassSecurityTrustStyle(style);\n\t}\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n\tname: 'safeUrl'\n})\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class SafeUrlPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate sanitizer: DomSanitizer\n\t) { }\n\n\ttransform(url: string) {\n\t\treturn this.sanitizer.bypassSecurityTrustResourceUrl(url);\n\t}\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n\tname: 'safeHtml'\n})\nexport class TrustPipe implements PipeTransform {\n\n\tconstructor(\n\t\tprivate sanitizer: DomSanitizer\n\t) { }\n\n\ttransform(text: string) {\n\t\treturn this.sanitizer.bypassSecurityTrustHtml(text);\n\t\t// return this.sanitizer.bypassSecurityTrustStyle(text);\n\t\t// return this.sanitizer.bypassSecurityTrustXxx(text); - see docs\n\t}\n}\n","import { Directive, ElementRef, EventEmitter, HostListener, Output } from '@angular/core';\r\n\r\n@Directive({\r\n\tselector: '[clickOutside]'\r\n})\r\nexport class ClickOutsideDirective {\r\n\r\n\tconstructor(\r\n\t\tprivate element: ElementRef\r\n\t) { }\r\n\r\n\t@Output() public clickOutside = new EventEmitter();\r\n\r\n\t@HostListener('document:click', ['$event'])\r\n\tpublic onClick(e: Event) {\r\n\t\tconst targetElement: Element = e.target as Element;\r\n\t\t// console.log('ClickOutsideDirective.onClick', this.element.nativeElement, targetElement, this.element.nativeElement.contains(targetElement));\r\n\t\t// const documentContained: boolean = Boolean(document.compareDocumentPosition(targetElement) & Node.DOCUMENT_POSITION_CONTAINED_BY);\r\n\t\t// console.log(targetElement, documentContained);\r\n\t\tconst clickedInside = this.element.nativeElement.contains(targetElement) || !document.contains(targetElement);\r\n\t\tif (!clickedInside) {\r\n\t\t\tthis.clickOutside.emit(null);\r\n\t\t}\r\n\t}\r\n}\r\n","import { isPlatformBrowser } from '@angular/common';\r\nimport { AfterViewInit, Directive, ElementRef, Inject, Input, NgZone, PLATFORM_ID } from '@angular/core';\r\n// import * as $fancybox from '@fancyapps/fancybox';\r\n// import * as $ from 'jquery'; // this reload jquery breaking fancybox\r\n\r\n// const $: any = window ? (window['$'] || {}) : {}; // !!! rimuovere\r\ndeclare var $: any; // use $ for jquery // !!! rimuovere\r\n\r\n@Directive({\r\n\tselector: '[fancybox]',\r\n})\r\n\r\nexport class FancyboxDirective implements AfterViewInit {\r\n\r\n\t@Input() fancybox: any;\r\n\t@Input() target: string;\r\n\r\n\tconstructor(\r\n\t\t@Inject(PLATFORM_ID) private platformId: string,\r\n\t\tprivate zone: NgZone,\r\n\t\tprivate element: ElementRef\r\n\t) { }\r\n\r\n\tngAfterViewInit() {\r\n\t\tif (isPlatformBrowser(this.platformId)) {\r\n\t\t\tthis.zone.runOutsideAngular(() => {\r\n\t\t\t\t$(() => {\r\n\t\t\t\t\t// $(this.element.nativeElement).fancybox(this.fancybox);\r\n\t\t\t\t\tconst group: any[] = Array.from($(this.element.nativeElement).find(this.target));\r\n\t\t\t\t\tgroup.forEach((item: HTMLElement, i: number) => item.addEventListener('click', (e) => {\r\n\t\t\t\t\t\t$.fancybox.open(group, this.fancybox, i);\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\t\t}));\r\n\t\t\t\t\t// console.log(group);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { isPlatformBrowser } from '@angular/common';\r\nimport { Directive, ElementRef, Inject, Input, NgZone, OnDestroy, OnInit, PLATFORM_ID, Renderer2 } from '@angular/core';\r\n\r\ndeclare var require: any; // use require for polyfill\r\n\r\n@Directive({\r\n\tselector: '[lazy-images]'\r\n})\r\nexport class LazyImagesDirective implements OnInit, OnDestroy {\r\n\r\n\t@Input()\r\n\tlazyImages: Object;\r\n\tobserver: IntersectionObserver;\r\n\tnativeElement: HTMLElement;\r\n\r\n\tconstructor(\r\n\t\t@Inject(PLATFORM_ID) private platformId: string,\r\n\t\telement: ElementRef,\r\n\t\tpublic renderer: Renderer2,\r\n\t\tpublic zone: NgZone,\r\n\t) {\r\n\t\tthis.nativeElement = element.nativeElement;\r\n\t}\r\n\r\n\tngOnInit() {\r\n\t\tif (!isPlatformBrowser(this.platformId)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.zone.runOutsideAngular(() => {\r\n\t\t\trequire('intersection-observer'); // use require for polyfill\r\n\t\t\tthis.onRegister();\r\n\t\t});\r\n\t}\r\n\r\n\tngOnDestroy() {\r\n\t\tif (this.observer) {\r\n\t\t\tthis.observer.disconnect();\r\n\t\t}\r\n\t}\r\n\r\n\tonRegister() {\r\n\t\tthis.newIntersectionObserver();\r\n\t\tconst observer = new MutationObserver(mutations => this.onChange(mutations));\r\n\t\tconst config = {\r\n\t\t\tattributes: true,\r\n\t\t\tcharacterData: true,\r\n\t\t\tchildList: true,\r\n\t\t\tsubtree: true\r\n\t\t};\r\n\t\tobserver.observe(this.nativeElement, config);\r\n\t\tthis.onChange();\r\n\t\t// this.observeDOMChanges(this.nativeElement, () => this.onChange);\r\n\t}\r\n\r\n\tonChange(...data) {\r\n\t\tconst images = Array.from(this.nativeElement.querySelectorAll('img[data-src], [data-srcset], [data-background-src]'));\r\n\t\timages.forEach((image: HTMLElement) => this.observer.observe(image));\r\n\t}\r\n\r\n\tnewIntersectionObserver() {\r\n\t\tconst config = this.lazyImages instanceof Object ? this.lazyImages : undefined;\r\n\t\tthis.observer = new IntersectionObserver((images: any[]) => images.forEach(image => {\r\n\t\t\tif (!image.isIntersecting) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.onAppearsInViewport(image.target);\r\n\t\t}), config);\r\n\t\treturn this.observer;\r\n\t}\r\n\r\n\tonAppearsInViewport(image: any) {\r\n\t\tif (image.dataset.src) {\r\n\t\t\tconst input = image.dataset.src;\r\n\t\t\tthis.onImagePreload(input, (output) => {\r\n\t\t\t\tthis.renderer.setAttribute(image, 'src', output);\r\n\t\t\t\tthis.renderer.removeAttribute(image, 'data-src');\r\n\t\t\t\tthis.zone.runOutsideAngular(() => {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.renderer.addClass(image, 'ready');\r\n\t\t\t\t\t}, 1);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (image.dataset.srcset) {\r\n\t\t\tthis.renderer.setAttribute(image, 'srcset', image.dataset.srcset);\r\n\t\t\tthis.renderer.removeAttribute(image, 'data-srcset');\r\n\t\t}\r\n\t\tif (image.dataset.backgroundSrc) {\r\n\t\t\tthis.renderer.setStyle(image, 'background-image', `url(${image.dataset.backgroundSrc})`);\r\n\t\t\tthis.renderer.removeAttribute(image, 'data-background-src');\r\n\t\t}\r\n\t\tif (this.observer) {\r\n\t\t\tthis.observer.unobserve(image);\r\n\t\t}\r\n\t}\r\n\r\n\tonImagePreload(src: string, callback: Function) {\r\n\t\tconst img = new Image();\r\n\t\timg.onload = () => {\r\n\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\tcallback(img.src);\r\n\t\t\t}\r\n\t\t};\r\n\t\timg.onerror = function (e) {\r\n\t\t\timg.onerror = null;\r\n\t\t\timg.src = 'data:image/png;base64,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';\r\n\t\t};\r\n\t\timg.src = src;\r\n\t}\r\n\r\n}\r\n","import { EventEmitter, Injectable, Provider } from '@angular/core';\r\n\r\nexport enum ModalEventType {\r\n\tComplete = 0,\r\n\tClose = 1,\r\n}\r\n\r\nexport class ModalCompleteEvent {\r\n\tmodal: Modal;\r\n\tdata?: any;\r\n\ttype?: ModalEventType.Complete = ModalEventType.Complete;\r\n\r\n\tconstructor(options?: ModalCompleteEvent) {\r\n\t\t// console.log('ModalCompleteEvent', options);\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class ModalCloseEvent {\r\n\tmodal: Modal;\r\n\tdata?: any;\r\n\ttype?: ModalEventType.Close = ModalEventType.Close;\r\n\r\n\tconstructor(options?: ModalCloseEvent) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport type ModalEvent<T> = ModalCompleteEvent | ModalCloseEvent;\r\n\r\n@Injectable({\r\n\tprovidedIn: 'root'\r\n})\r\nexport class Modal {\r\n\tcomponent: any;\r\n\tproviders?: Provider = [];\r\n\tdata?: any;\r\n\temitter?: EventEmitter<ModalCompleteEvent | ModalCloseEvent> = new EventEmitter();\r\n\tclassName?: string;\r\n\r\n\tconstructor(options?: Modal) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n@Injectable({\r\n\tprovidedIn: 'root'\r\n})\r\nexport class ModalData extends Object { }\r\n","import { isPlatformBrowser } from '@angular/common';\nimport { EventEmitter, Inject, Injectable, PLATFORM_ID } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { Modal, ModalCloseEvent, ModalCompleteEvent } from './modal';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class ModalService {\n\n\tmodals$ = new BehaviorSubject<Modal[]>([]);\n\n\tconstructor(\n\t\t@Inject(PLATFORM_ID) private platformId: string\n\t) { }\n\n\tgetInfos(): Observable<Modal> {\n\t\treturn this.modals$.pipe(\n\t\t\tmap((modals: Modal[]) => {\n\t\t\t\treturn modals.length ? modals[modals.length - 1] : null;\n\t\t\t})\n\t\t);\n\t}\n\n\taddClass(name: string): void {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tconst body = document.querySelector('body') as HTMLElement;\n\t\t\tbody.classList.add(name);\n\t\t}\n\t}\n\n\tremoveClass(name: string): void {\n\t\tif (isPlatformBrowser(this.platformId)) {\n\t\t\tconst body = document.querySelector('body') as HTMLElement;\n\t\t\tbody.classList.remove(name);\n\t\t}\n\t}\n\n\topen(modal: Modal): EventEmitter<ModalCompleteEvent | ModalCloseEvent> {\n\t\tthis.addClass('modal-active');\n\t\tmodal = new Modal(modal);\n\t\tconst modals = this.modals$.getValue();\n\t\tmodals.push(modal);\n\t\tthis.modals$.next(modals);\n\t\treturn modal.emitter;\n\t\t// event emitter bound to modals$\n\t}\n\n\tcomplete(modal?: Modal, data?: any): void {\n\t\tmodal = modal ? this.remove(modal) : this.pop();\n\t\tif (modal) {\n\t\t\tmodal.emitter.emit(new ModalCompleteEvent({ modal: modal, data: data }));\n\t\t}\n\t}\n\n\tclose(modal?: Modal, data?: any): void {\n\t\tmodal = this.removeAll();\n\t\tif (modal) {\n\t\t\tmodal.emitter.emit(new ModalCloseEvent({ modal: modal, data: data }));\n\t\t}\n\t}\n\n\tprev(modal?: Modal, data?: any): void {\n\t\tmodal = modal ? this.remove(modal) : this.pop();\n\t\tif (modal) {\n\t\t\tmodal.emitter.emit(new ModalCloseEvent({ modal: modal, data: data }));\n\t\t}\n\t}\n\n\tprivate pop(): Modal {\n\t\tconst modals = this.modals$.getValue();\n\t\tif (modals.length) {\n\t\t\tconst modal = modals.pop();\n\t\t\tif (!modals.length) {\n\t\t\t\tthis.removeClass('modal-active');\n\t\t\t}\n\t\t\tthis.modals$.next(modals);\n\t\t\treturn modal;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tprivate remove(modal: Modal): Modal {\n\t\tconst modals = this.modals$.getValue();\n\t\tif (modals.length && modals[modals.length - 1] === modal) {\n\t\t\tmodals.pop();\n\t\t\tif (!modals.length) {\n\t\t\t\tthis.removeClass('modal-active');\n\t\t\t}\n\t\t\tthis.modals$.next(modals);\n\t\t\treturn modal;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tprivate removeAll(): Modal {\n\t\tconst modals = this.modals$.getValue();\n\t\tif (modals.length) {\n\t\t\tconst modal = modals.pop();\n\t\t\tthis.removeClass('modal-active');\n\t\t\tthis.modals$.next([]);\n\t\t\treturn modal;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/*\n\tinit(component: any, providers: object, outputs: object) {\n\t\tconst config = { inputs: providers, outputs };\n\t\tthis.domService.appendComponentTo(this.modalElementId, component, config);\n\t\tdocument.getElementById(this.modalElementId).className = 'show';\n\t\tdocument.getElementById(this.overlayElementId).className = 'show';\n\t}\n\n\tdestroy() {\n\t\tthis.domService.removeComponent();\n\t\tdocument.getElementById(this.modalElementId).className = 'hidden';\n\t\tdocument.getElementById(this.overlayElementId).className = 'hidden';\n\t}\n\t*/\n\n}\n","import { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { map, takeUntil } from 'rxjs/operators';\nimport { DisposableComponent } from '../../disposable/disposable.component';\nimport { Modal } from './modal';\nimport { ModalService } from './modal.service';\n\n@Component({\n\tselector: 'ws-modal-container-component',\n\ttemplateUrl: './modal-container.component.html',\n\tstyleUrls: ['./modal-container.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\n\nexport class ModalContainerComponent extends DisposableComponent implements OnInit {\n\n\tmodalCount: number = 0;\n\tclassName?: string;\n\n\tconstructor(\n\t\tpublic modalService: ModalService\n\t) {\n\t\tsuper();\n\t}\n\n\tngOnInit() {\n\t\tthis.modalService.modals$.pipe(\n\t\t\ttakeUntil(this.unsubscribe),\n\t\t\tmap((modals: Modal[]) => {\n\t\t\t\tthis.modalCount = modals.length;\n\t\t\t\tconst modal = modals.length ? modals[modals.length - 1] : null;\n\t\t\t\treturn modal;\n\t\t\t})\n\t\t).subscribe((modal: Modal) => {\n\t\t\tthis.className = modal ? modal.className : null;\n\t\t});\n\t}\n\n\tdoClose() {\n\t\tthis.modalService.close();\n\t}\n\n\tdoPrev() {\n\t\tthis.modalService.prev();\n\t}\n\n}\n","import { Component, ComponentFactoryResolver, ComponentRef, Input, OnDestroy, Provider, ReflectiveInjector, ViewChild, ViewContainerRef, ViewEncapsulation } from '@angular/core';\nimport { DisposableComponent } from '../../disposable/disposable.component';\nimport { Modal, ModalData } from './modal';\n\n@Component({\n\tselector: 'ws-modal-view-component',\n\ttemplateUrl: './modal-view.component.html',\n\tstyleUrls: ['./modal-view.component.scss'],\n\tencapsulation: ViewEncapsulation.Emulated,\n})\nexport class ModalViewComponent extends DisposableComponent implements OnDestroy {\n\n\tcomponent: ComponentRef<any>;\n\n\t@ViewChild('modalContainer', { read: ViewContainerRef }) modalContainer: ViewContainerRef;\n\n\t@Input() set modal(modal: Modal) {\n\t\tif (this.component) {\n\t\t\tthis.component.destroy();\n\t\t}\n\t\tif (!modal) {\n\t\t\tthis.component = null;\n\t\t\treturn;\n\t\t}\n\t\tconst providers: Provider = Object.keys(modal.providers).map(key => {\n\t\t\treturn { provide: key, useValue: modal.providers[key] };\n\t\t});\n\t\tproviders.push(\n\t\t\t{ provide: ModalData, useValue: modal.data },\n\t\t\t{ provide: Modal, useValue: modal },\n\t\t);\n\t\tconst resolvedInputs = ReflectiveInjector.resolve(providers);\n\t\tconst injector = ReflectiveInjector.fromResolvedProviders(resolvedInputs, this.modalContainer.parentInjector);\n\t\tconst factory = this.resolver.resolveComponentFactory(modal.component);\n\t\tconst component = factory.create(injector);\n\t\tthis.modalContainer.insert(component.hostView);\n\t\tthis.component = component;\n\t}\n\n\tconstructor(\n\t\tprivate resolver: ComponentFactoryResolver\n\t) {\n\t\tsuper();\n\t}\n\n\tngOnDestroy() {\n\t\tif (this.component) {\n\t\t\tthis.component.destroy();\n\t\t\tthis.component = null;\n\t\t}\n\t}\n\n}\n","import { CommonModule } from '@angular/common';\r\nimport { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';\r\nimport { ModuleWithProviders, NgModule, Optional, SkipSelf } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { MarkdownModule, MarkedOptions } from 'ngx-markdown';\r\nimport { AuthService } from './auth/auth.service';\r\nimport { ConfigService } from './config/config.service';\r\nimport { CoreConfig, CORE_CONFIG } from './config/core.config';\r\nimport { DefaultContentDirective } from './content/default-content.directive';\r\nimport { CoreComponent } from './core.component';\r\nimport { CoreRouting } from './core.routing';\r\nimport { DisposableComponent } from './disposable/disposable.component';\r\nimport { EditorComponent } from './editor/editor.component';\r\nimport { ControlComponent } from './forms/controls/control.component';\r\nimport { ControlService } from './forms/controls/control.service';\r\nimport { ExistsValidator } from './forms/exists.validator';\r\nimport { FormService } from './forms/form.service';\r\nimport { MatchValidator } from './forms/match.validator';\r\nimport { UppercaseDirective } from './forms/uppercase.directive';\r\nimport { HighlightPipe } from './highlight/highlight.pipe';\r\nimport { HttpResponseInterceptor } from './http/http-response.interceptor';\r\nimport { HttpStatusCodeService } from './http/http-status-code.service';\r\nimport { JsonFormatterComponent } from './json-formatter/json-formatter.component';\r\nimport { LabelAsyncPipe } from './labels/label-async.pipe';\r\nimport { LabelDirective } from './labels/label.directive';\r\nimport { LabelPipe } from './labels/label.pipe';\r\nimport { LabelService } from './labels/label.service';\r\nimport { Logger } from './logger/logger';\r\nimport { LoggerComponent } from './logger/logger.component';\r\nimport { EventDispatcherService } from './models/event-dispatcher.service';\r\nimport { MenuService } from './models/menu.service';\r\nimport { OnceService } from './once/once.service';\r\nimport { PageNotFoundComponent } from './pages/page-not-found.component';\r\nimport { PageOutletComponent } from './pages/page-outlet.component';\r\nimport { PageComponent } from './pages/page.component';\r\nimport { PageGuard } from './pages/page.guard';\r\nimport { PageService } from './pages/page.service';\r\nimport { StaticGuard } from './pages/static.guard';\r\nimport { AssetPipe } from './pipes/asset.pipe';\r\nimport { CustomAsyncPipe } from './pipes/custom-async.pipe';\r\nimport { ImagePipe } from './pipes/image.pipe';\r\nimport { PublicPipe } from './pipes/public.pipe';\r\nimport { SegmentPipe } from './pipes/segment.pipe';\r\nimport { FacebookService } from './plugins/facebook/facebook.service';\r\nimport { GoogleTagManagerComponent } from './plugins/google/google-tag-manager.component';\r\nimport { GoogleTagManagerService } from './plugins/google/google-tag-manager.service';\r\nimport { GoogleService } from './plugins/google/google.service';\r\nimport { MapboxService } from './plugins/mapbox/mapbox.service';\r\nimport { PayPalWidgetComponent } from './plugins/paypal/paypal-widget.component';\r\nimport { PayPalService } from './plugins/paypal/paypal.service';\r\nimport { TrustPilotWidgetComponent } from './plugins/trustpilot/trustpilot-widget.component';\r\nimport { TrustPilotService } from './plugins/trustpilot/trustpilot.service';\r\nimport { RoutePipe } from './routes/route.pipe';\r\nimport { SlugAsyncPipe } from './slugs/slug-async.pipe';\r\nimport { SlugPipe } from './slugs/slug.pipe';\r\nimport { CookieStorageService, LocalStorageService, SessionStorageService, StorageService } from './storage/storage.service';\r\nimport { TranslatePipe } from './translate/translate.pipe';\r\nimport { SafeStylePipe } from './trust/safe-style.pipe';\r\nimport { SafeUrlPipe } from './trust/safe-url.pipe';\r\nimport { TrustPipe } from './trust/trust.pipe';\r\nimport { ClickOutsideDirective } from './ui/click-outside/click-outside.directive';\r\nimport { FancyboxDirective } from './ui/fancybox/fancybox.directive';\r\nimport { LazyImagesDirective } from './ui/lazy-images/lazy-images.directive';\r\nimport { ModalContainerComponent } from './ui/modal/modal-container.component';\r\nimport { ModalViewComponent } from './ui/modal/modal-view.component';\r\nimport { ModalService } from './ui/modal/modal.service';\r\n\r\n@NgModule({\r\n\timports: [\r\n\t\tCommonModule,\r\n\t\tHttpClientModule,\r\n\t\tFormsModule,\r\n\t\tReactiveFormsModule,\r\n\t\tCoreRouting,\r\n\t\tMarkdownModule.forRoot({\r\n\t\t\tmarkedOptions: {\r\n\t\t\t\tprovide: MarkedOptions,\r\n\t\t\t\tuseValue: {\r\n\t\t\t\t\t// gfm: true,\r\n\t\t\t\t\t// tables: true,\r\n\t\t\t\t\t// breaks: true,\r\n\t\t\t\t\t// pedantic: true,\r\n\t\t\t\t\t// sanitize: true,\r\n\t\t\t\t\t// smartLists: true,\r\n\t\t\t\t\t// smartypants: true,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t}),\r\n\t],\r\n\tdeclarations: [\r\n\t\tAssetPipe,\r\n\t\tClickOutsideDirective,\r\n\t\tControlComponent,\r\n\t\tCoreComponent,\r\n\t\tCustomAsyncPipe,\r\n\t\tDefaultContentDirective,\r\n\t\tDisposableComponent,\r\n\t\tEditorComponent,\r\n\t\tExistsValidator,\r\n\t\tFancyboxDirective,\r\n\t\tGoogleTagManagerComponent,\r\n\t\tHighlightPipe,\r\n\t\tImagePipe,\r\n\t\tJsonFormatterComponent,\r\n\t\tLabelAsyncPipe,\r\n\t\tLabelDirective,\r\n\t\tLabelPipe,\r\n\t\tLazyImagesDirective,\r\n\t\tLoggerComponent,\r\n\t\tMatchValidator,\r\n\t\tModalContainerComponent,\r\n\t\tModalViewComponent,\r\n\t\tPageComponent,\r\n\t\tPageNotFoundComponent,\r\n\t\tPageOutletComponent,\r\n\t\tPayPalWidgetComponent,\r\n\t\tPublicPipe,\r\n\t\tRoutePipe,\r\n\t\tSafeStylePipe,\r\n\t\tSafeUrlPipe,\r\n\t\tSegmentPipe,\r\n\t\tSlugAsyncPipe,\r\n\t\tSlugPipe,\r\n\t\tTranslatePipe,\r\n\t\tTrustPilotWidgetComponent,\r\n\t\tTrustPipe,\r\n\t\tUppercaseDirective,\r\n\t],\r\n\texports: [\r\n\t\tAssetPipe,\r\n\t\tClickOutsideDirective,\r\n\t\tControlComponent,\r\n\t\tCoreComponent,\r\n\t\tCustomAsyncPipe,\r\n\t\tDefaultContentDirective,\r\n\t\tEditorComponent,\r\n\t\tExistsValidator,\r\n\t\tFancyboxDirective,\r\n\t\tGoogleTagManagerComponent,\r\n\t\tHighlightPipe,\r\n\t\tImagePipe,\r\n\t\tJsonFormatterComponent,\r\n\t\tLabelAsyncPipe,\r\n\t\tLabelDirective,\r\n\t\tLabelPipe,\r\n\t\tLazyImagesDirective,\r\n\t\tLoggerComponent,\r\n\t\tMatchValidator,\r\n\t\tModalContainerComponent,\r\n\t\tModalViewComponent,\r\n\t\tPageComponent,\r\n\t\tPayPalWidgetComponent,\r\n\t\tPublicPipe,\r\n\t\tRoutePipe,\r\n\t\tSafeStylePipe,\r\n\t\tSafeUrlPipe,\r\n\t\tSegmentPipe,\r\n\t\tSlugAsyncPipe,\r\n\t\tSlugPipe,\r\n\t\tTranslatePipe,\r\n\t\tTrustPilotWidgetComponent,\r\n\t\tTrustPipe,\r\n\t\tUppercaseDirective,\r\n\t],\r\n\tproviders: [\r\n\t\t{ provide: HTTP_INTERCEPTORS, useClass: HttpResponseInterceptor, multi: true },\r\n\t\tAssetPipe,\r\n\t\tAuthService,\r\n\t\tConfigService,\r\n\t\tControlService,\r\n\t\tCookieStorageService,\r\n\t\tCustomAsyncPipe,\r\n\t\tEventDispatcherService,\r\n\t\tExistsValidator,\r\n\t\tFacebookService,\r\n\t\tFormService,\r\n\t\tGoogleService,\r\n\t\tGoogleTagManagerService,\r\n\t\tHighlightPipe,\r\n\t\tHttpStatusCodeService,\r\n\t\tImagePipe,\r\n\t\tLabelPipe,\r\n\t\tLabelService,\r\n\t\tLocalStorageService,\r\n\t\tLogger,\r\n\t\tMapboxService,\r\n\t\tMatchValidator,\r\n\t\tMenuService,\r\n\t\tModalService,\r\n\t\tOnceService,\r\n\t\tPageGuard, StaticGuard,\r\n\t\tPageService,\r\n\t\tPayPalService,\r\n\t\tPublicPipe,\r\n\t\tRoutePipe,\r\n\t\tSafeUrlPipe,\r\n\t\tSegmentPipe,\r\n\t\tSessionStorageService,\r\n\t\tSlugAsyncPipe,\r\n\t\tSlugPipe,\r\n\t\tStorageService,\r\n\t\tTranslatePipe,\r\n\t\tTrustPilotService,\r\n\t\tTrustPipe,\r\n\t],\r\n})\r\n\r\nexport class CoreModule {\r\n\r\n\tconstructor(\r\n\t\t@Optional() @SkipSelf() parentModule: CoreModule\r\n\t) {\r\n\t\tif (parentModule) {\r\n\t\t\tthrow new Error('CoreModule is already loaded. Import it in the AppModule only');\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static forRoot(\r\n\t\tconfig?: CoreConfig,\r\n\t): ModuleWithProviders {\r\n\t\treturn {\r\n\t\t\tngModule: CoreModule,\r\n\t\t\tproviders: [\r\n\t\t\t\t{ provide: CORE_CONFIG, useValue: config },\r\n\t\t\t]\r\n\t\t};\r\n\t}\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class CoreService {\n\n\tconstructor() { }\n}\n","import { Entity } from '../models/entity';\n\nexport class Label implements Entity {\n\tid: number | string;\n\tname: string;\n\tlang: string;\n\tlabels?: any;\n}\n","import { Entity } from './entity';\n\nexport class Document implements Entity {\n\tid: number | string;\n\tname?: string;\n\ttitle?: string;\n\tdescription?: string;\n\tslug?: string;\n}\n\nexport class DocumentIndex {\n\tid: number | string;\n\tmnemonic?: string;\n\tslug?: string;\n}\n\n","import { Document } from './document';\nimport { Image } from './image';\n\nexport class MenuItem implements Document {\n\tid: number | string;\n\tname?: string;\n\ttitle?: string;\n\tabstract?: string;\n\tslug?: string;\n\turl?: string;\n\ttype?: number | string;\n\timages?: Image[];\n\titems?: MenuItem[];\n\n\tconstructor(options?: any) {\n\t\tif (options) {\n\t\t\tObject.assign(this, options);\n\t\t\tif (options.items) {\n\t\t\t\tthis.items = options.items.map(item => new MenuItem(item));\n\t\t\t}\n\t\t}\n\t}\n}\n"]}